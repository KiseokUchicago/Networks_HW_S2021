<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="KiseokUchicago" />

<meta name="date" content="2021-04-19" />

<title>Networks_HW3</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<link rel="icon" href="https://github.com/workflowr/workflowr-assets/raw/master/img/reproducible.png">
<!-- Add a small amount of space between sections. -->
<style type="text/css">
div.section {
  padding-top: 12px;
}
</style>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>








<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-sm-12 col-md-4 col-lg-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-sm-12 col-md-8 col-lg-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Networks_HW_S2021</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
<li>
  <a href="license.html">License</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/KiseokUchicago/Networks_HW_S2021">
    <span class="fas fa-github"></span>
     
    Source code
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Networks_HW3</h1>
<h4 class="author">KiseokUchicago</h4>
<h4 class="date">2021-04-19</h4>

</div>


<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-report" data-toggle="collapse" data-target="#workflowr-report">
<span class="glyphicon glyphicon-list" aria-hidden="true"></span> workflowr <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span>
</button>
</p>
<div id="workflowr-report" class="collapse">
<ul class="nav nav-tabs">
<li class="active">
<a data-toggle="tab" href="#summary">Summary</a>
</li>
<li>
<a data-toggle="tab" href="#checks"> Checks <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> </a>
</li>
<li>
<a data-toggle="tab" href="#versions">Past versions</a>
</li>
</ul>
<div class="tab-content">
<div id="summary" class="tab-pane fade in active">
<p>
<strong>Last updated:</strong> 2021-04-24
</p>
<p>
<strong>Checks:</strong> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> 7 <span class="glyphicon glyphicon-exclamation-sign text-danger" aria-hidden="true"></span> 0
</p>
<p>
<strong>Knit directory:</strong> <code>Networks_HW_S2021/</code> <span class="glyphicon glyphicon-question-sign" aria-hidden="true" title="This is the local directory in which the code in this file was executed."> </span>
</p>
<p>
This reproducible <a href="http://rmarkdown.rstudio.com">R Markdown</a> analysis was created with <a
  href="https://github.com/jdblischak/workflowr">workflowr</a> (version 1.6.2). The <em>Checks</em> tab describes the reproducibility checks that were applied when the results were created. The <em>Past versions</em> tab lists the development history.
</p>
<hr>
</div>
<div id="checks" class="tab-pane fade">
<div id="workflowr-checks" class="panel-group">
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRMarkdownfilestronguptodate"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>R Markdown file:</strong> up-to-date </a>
</p>
</div>
<div id="strongRMarkdownfilestronguptodate" class="panel-collapse collapse">
<div class="panel-body">
<p>Great! Since the R Markdown file has been committed to the Git repository, you know the exact version of the code that produced these results.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongEnvironmentstrongempty"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Environment:</strong> empty </a>
</p>
</div>
<div id="strongEnvironmentstrongempty" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! The global environment was empty. Objects defined in the global environment can affect the analysis in your R Markdown file in unknown ways. For reproduciblity it’s best to always run the code in an empty environment.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSeedstrongcodesetseed20210409code"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Seed:</strong> <code>set.seed(20210409)</code> </a>
</p>
</div>
<div id="strongSeedstrongcodesetseed20210409code" class="panel-collapse collapse">
<div class="panel-body">
<p>The command <code>set.seed(20210409)</code> was run prior to running the code in the R Markdown file. Setting a seed ensures that any results that rely on randomness, e.g. subsampling or permutations, are reproducible.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSessioninformationstrongrecorded"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Session information:</strong> recorded </a>
</p>
</div>
<div id="strongSessioninformationstrongrecorded" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Recording the operating system, R version, and package versions is critical for reproducibility.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongCachestrongnone"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Cache:</strong> none </a>
</p>
</div>
<div id="strongCachestrongnone" class="panel-collapse collapse">
<div class="panel-body">
<p>Nice! There were no cached chunks for this analysis, so you can be confident that you successfully produced the results during this run.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongFilepathsstrongrelative"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>File paths:</strong> relative </a>
</p>
</div>
<div id="strongFilepathsstrongrelative" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Using relative paths to the files within your workflowr project makes it easier to run your code on other machines.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRepositoryversionstrongahrefhttpsgithubcomKiseokUchicagoNetworksHWS2021tree2d07fa0dbc659f81d8474e7ee2972b70bf9f6efatargetblank2d07fa0a"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Repository version:</strong> <a href="https://github.com/KiseokUchicago/Networks_HW_S2021/tree/2d07fa0dbc659f81d8474e7ee2972b70bf9f6efa" target="_blank">2d07fa0</a> </a>
</p>
</div>
<div id="strongRepositoryversionstrongahrefhttpsgithubcomKiseokUchicagoNetworksHWS2021tree2d07fa0dbc659f81d8474e7ee2972b70bf9f6efatargetblank2d07fa0a" class="panel-collapse collapse">
<div class="panel-body">
<p>
Great! You are using Git for version control. Tracking code development and connecting the code version to the results is critical for reproducibility.
</p>
<p>
The results in this page were generated with repository version <a href="https://github.com/KiseokUchicago/Networks_HW_S2021/tree/2d07fa0dbc659f81d8474e7ee2972b70bf9f6efa" target="_blank">2d07fa0</a>. See the <em>Past versions</em> tab to see a history of the changes made to the R Markdown and HTML files.
</p>
<p>
Note that you need to be careful to ensure that all relevant files for the analysis have been committed to Git prior to generating the results (you can use <code>wflow_publish</code> or <code>wflow_git_commit</code>). workflowr only checks the R Markdown file, but you know if there are other scripts or data files that it depends on. Below is the status of the Git repository when the results were generated:
</p>
<pre><code>
Ignored files:
    Ignored:    .Rhistory
    Ignored:    .Rproj.user/

Untracked files:
    Untracked:  data/1_0.3_edge_mer.css.ss.5.tsv
    Untracked:  data/1_0.3_node_mer.css.ss.5.tsv
    Untracked:  data/2_0.3_edge_dom.css.ss.5.tsv
    Untracked:  data/2_0.3_node_dom.css.ss.5.tsv
    Untracked:  data/3_0.3_edge_wil.css.ss.5.tsv
    Untracked:  data/3_0.3_node_wil.css.ss.5.tsv
    Untracked:  data/4_0.3_edge_phy.css.ss.5.tsv
    Untracked:  data/5_0.3_edge_dom.phy.ss.5.tsv
    Untracked:  data/6_0.3_edge_wil.phy.ss.5.tsv
    Untracked:  data/7_0.3_edge_fun.css.ss.5.tsv
    Untracked:  data/8_0.3_edge_dom.fun.ss.5.tsv
    Untracked:  data/9_0.3_edge_wil.fun.ss.5.tsv
    Untracked:  data/Chesapeake_bay_links.csv
    Untracked:  data/Chesapeake_bay_nodes.csv
    Untracked:  data/Dunne2013PBioSupData.xlsx
    Untracked:  data/M_PA_003.csv
    Untracked:  data/Otago_Data_Links.csv
    Untracked:  data/Otago_Data_Nodes.csv
    Untracked:  data/Ural_valley_A_HP_048.csv
    Untracked:  data/vizentin-bugoni_et_al_2016_complementary.xlsx

</code></pre>
<p>
Note that any generated files, e.g. HTML, png, CSS, etc., are not included in this status report because it is ok for generated content to have uncommitted changes.
</p>
</div>
</div>
</div>
</div>
<hr>
</div>
<div id="versions" class="tab-pane fade">

<p>
These are the previous versions of the repository in which changes were made to the R Markdown (<code>analysis/Networks_HW3.Rmd</code>) and HTML (<code>docs/Networks_HW3.html</code>) files. If you’ve configured a remote Git repository (see <code>?wflow_git_remote</code>), click on the hyperlinks in the table below to view the files as they were in that past version.
</p>
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
File
</th>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
<th>
Message
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/KiseokUchicago/Networks_HW_S2021/blob/2d07fa0dbc659f81d8474e7ee2972b70bf9f6efa/analysis/Networks_HW3.Rmd" target="_blank">2d07fa0</a>
</td>
<td>
KiseokUchicago
</td>
<td>
2021-04-24
</td>
<td>
HW3
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/KiseokUchicago/Networks_HW_S2021/912dd8db531d8ba519126b9626f5bdef5947f7e5/docs/Networks_HW3.html" target="_blank">912dd8d</a>
</td>
<td>
KiseokUchicago
</td>
<td>
2021-04-24
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/KiseokUchicago/Networks_HW_S2021/blob/c02f513258c1e5e9042a3ba6d2c2e34f651a365e/analysis/Networks_HW3.Rmd" target="_blank">c02f513</a>
</td>
<td>
KiseokUchicago
</td>
<td>
2021-04-24
</td>
<td>
HW3
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/KiseokUchicago/Networks_HW_S2021/2a4b5542c559bd7d83a4d4d5ecc2b22a418cd070/docs/Networks_HW3.html" target="_blank">2a4b554</a>
</td>
<td>
KiseokUchicago
</td>
<td>
2021-04-24
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/KiseokUchicago/Networks_HW_S2021/blob/436e3febde0ea09501b77a4442f8b67a0f13ffad/analysis/Networks_HW3.Rmd" target="_blank">436e3fe</a>
</td>
<td>
KiseokUchicago
</td>
<td>
2021-04-24
</td>
<td>
HW3
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/KiseokUchicago/Networks_HW_S2021/fd62530129cbe1f90a2fcbc7b1ef277f3321f627/docs/Networks_HW3.html" target="_blank">fd62530</a>
</td>
<td>
KiseokUchicago
</td>
<td>
2021-04-19
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/KiseokUchicago/Networks_HW_S2021/blob/6468cf1059413f4d35405be1516a9fd9e1a829f1/analysis/Networks_HW3.Rmd" target="_blank">6468cf1</a>
</td>
<td>
KiseokUchicago
</td>
<td>
2021-04-19
</td>
<td>
begin
</td>
</tr>
</tbody>
</table>
</div>
<hr>
</div>
</div>
</div>
<div id="homework3-community-detection-modularity" class="section level2">
<h2>Homework3 (Community detection, modularity)</h2>
</div>
<div id="coding-assignment-for-ecev-44500-networks-in-ecology-and-evolution" class="section level2">
<h2>Coding assignment for ECEV 44500 Networks in Ecology and Evolution</h2>
<p>Professor: <strong>Mercedes Pascual</strong>, <strong>Sergio A. Alcala Corona</strong><br />
Student: <strong>Kiseok Lee</strong></p>
<pre class="r"><code># libraries
library(igraph)
library(bipartite)
library(dplyr)
library(ggplot2)
library(RColorBrewer)</code></pre>
</div>
<div id="community-detection-a.k.a-modularity" class="section level2">
<h2>1. Community detection (a.k.a “modularity”)</h2>
</div>
<div id="unipartite-networks" class="section level2">
<h2>1.1 Unipartite networks</h2>
<p>community structure detection algorithms are different.</p>
<div id="undirected-unweighted" class="section level3">
<h3>1.1.1. Undirected, unweighted</h3>
<p>Let’s try to detect communities in the Chesapeake Food Web from the last lab. This is a quantitative food web but for simplicity at this first stage we will work with an undirected, unweighted graph.</p>
<pre class="r"><code># Load the web
chesapeake_nodes &lt;- read.csv(&#39;data/Chesapeake_bay_nodes.csv&#39;, header=F)
names(chesapeake_nodes) &lt;- c(&#39;nodeId&#39;,&#39;species_name&#39;)
chesapeake_links &lt;- read.csv(&#39;data/Chesapeake_bay_links.csv&#39;, header=F)
names(chesapeake_links) &lt;- c(&#39;from&#39;,&#39;to&#39;,&#39;weight&#39;)
ches_web &lt;- graph.data.frame(chesapeake_links, vertices = chesapeake_nodes, directed = T)

# Detect communities, note the as.undirected command
ches_web_unweighted &lt;- ches_web
ches_web_unweighted &lt;- as.undirected(ches_web_unweighted)
E(ches_web_unweighted)$weight &lt;- 1

# implementing Louvain method
cl &lt;- cluster_louvain(ches_web_unweighted) # Can also use the weights = NULL argument
class(cl) # the result is of class communities</code></pre>
<pre><code>[1] &quot;communities&quot;</code></pre>
<pre class="r"><code># module membership &amp; visualization
module_membership &lt;- membership(cl)
cols &lt;- data.frame(mem=unique(module_membership), col= brewer.pal(length(unique(module_membership)), &#39;Set1&#39;))
V(ches_web_unweighted)$module_membership &lt;- module_membership
V(ches_web_unweighted)$color &lt;- cols$col[match(V(ches_web_unweighted)$module_membership, cols$mem)]
plot(ches_web_unweighted, vertex.color=V(ches_web_unweighted)$color, vertex.size=10, vertex.label=NA, edge.arrow.width=0.3, edge.arrow.curve=0.5)</code></pre>
<p><img src="figure/Networks_HW3.Rmd/unnamed-chunk-2-1.png" width="1056" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="problem-1.-can-you-identify-the-species-in-each-module-does-the-assignment-make-sense" class="section level2">
<h2>Problem 1. Can you identify the species in each module? Does the assignment make sense?</h2>
<pre class="r"><code>plot(ches_web_unweighted, vertex.color=V(ches_web_unweighted)$color, vertex.size=10, edge.arrow.width=0.3, edge.arrow.curve=0.5)</code></pre>
<p><img src="figure/Networks_HW3.Rmd/unnamed-chunk-3-1.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code>v_red &lt;- names(module_membership[module_membership==1])
v_blue &lt;- names(module_membership[module_membership==2])
v_green &lt;- names(module_membership[module_membership==3])

# red nodes
chesapeake_nodes %&gt;% filter(nodeId %in% v_red)</code></pre>
<pre><code>   nodeId                species_name
1       1              phytoplankton 
2       2  bacteria in suspended poc 
3       5              free bacteria 
4       6  heterotrophic microflagel 
5       7                   ciliates 
6       8                zooplankton 
7       9                ctenophores 
8      10                 sea nettle 
9      11   other suspension feeders 
10     12               mya arenaria 
11     13                    oysters 
12     34   dissolved organic carbon 
13     35  suspended particulate org 
14     37                      Input </code></pre>
<pre class="r"><code># blue nodes
chesapeake_nodes %&gt;% filter(nodeId %in% v_blue)</code></pre>
<pre><code>   nodeId                species_name
1       3   bacteria in sediment poc 
2       4            benthic diatoms 
3      14          other polychaetes 
4      15                     nereis 
5      16                macoma spp. 
6      17                  meiofauna 
7      18  crustacean deposit feeder 
8      19                  blue crab 
9      24                       shad 
10     25                    croaker 
11     26                  hogchoker 
12     27                       spot 
13     28                white perch 
14     29                    catfish 
15     36  sediment particulate orga 
16     39                Respiration </code></pre>
<pre class="r"><code># green nodes
chesapeake_nodes %&gt;% filter(nodeId %in% v_green)</code></pre>
<pre><code>  nodeId             species_name
1     20             fish larvae 
2     21  alewife &amp; blue herring 
3     22             bay anchovy 
4     23                menhaden 
5     30                bluefish 
6     31                weakfish 
7     32         summer flounder 
8     33            striped bass 
9     38                  Output </code></pre>
<p>Red nodes and Green nodes makes sense. Red node comprises of microorganism or aquatic animals that dwell in the waters. Green node seems to be bigger animals (top predators like fish). Blue node makes less sense with my prior knowledge. But module would consist of a food web that could include both predator and prey that are closely associated. Therefore, Green node could be artificial.</p>
</div>
<div id="problem-2-3.-try-a-different-community-detection-method-like-cluster_edge_betweenness.-are-there-any-differences-in-module-assignments" class="section level2">
<h2>Problem 2 &amp; 3. Try a different community detection method, like cluster_edge_betweenness. Are there any differences in module assignments?</h2>
<pre class="r"><code># implementing cluster_edge_betweenness method
cl_eb &lt;- cluster_edge_betweenness(ches_web_unweighted) # Can also use the weights = NULL argument
class(cl_eb) # the result is of class communities</code></pre>
<pre><code>[1] &quot;communities&quot;</code></pre>
<pre class="r"><code># module membership &amp; visualization
module_member &lt;- membership(cl_eb)
cols &lt;- data.frame(mem=unique(module_member), col= brewer.pal(length(unique(module_member)), &#39;Set1&#39;))
V(ches_web_unweighted)$module_member &lt;- module_member
V(ches_web_unweighted)$color2 &lt;- cols$col[match(V(ches_web_unweighted)$module_member, cols$mem)]
plot(ches_web_unweighted, vertex.color=V(ches_web_unweighted)$color2, vertex.size=10, vertex.label=NA, edge.arrow.width=0.3, edge.arrow.curve=0.5)</code></pre>
<p><img src="figure/Networks_HW3.Rmd/unnamed-chunk-4-1.png" width="1056" style="display: block; margin: auto;" /> Yes, they are very different from the previouse Louvain’s method. There are up to 7 modules compared to 3 modules before. Also, module 1 is dominant in number of nodes includes and other modules are relatively small, some modules even containing only 1 nodes.</p>
<div id="undirected-weighted" class="section level3">
<h3>1.1.2. Undirected, weighted</h3>
<pre class="r"><code>cl_wt &lt;- cluster_louvain(as.undirected(ches_web), weights = E(ches_web)$weight) #Notice the `weights` argument.
class(cl_wt) # the result is of class communities</code></pre>
<pre><code>[1] &quot;communities&quot;</code></pre>
<pre class="r"><code>module_membership_wt &lt;- membership(cl_wt)
cols &lt;- data.frame(mem=unique(module_membership_wt), col= brewer.pal(length(unique(module_membership_wt)), &#39;Set1&#39;))
V(ches_web)$module_membership_wt &lt;- module_membership_wt
V(ches_web)$color_wt &lt;- cols$col[match(V(ches_web)$module_membership_wt, cols$mem)]
plot(as.undirected(ches_web), vertex.color=V(ches_web)$color_wt, vertex.size=5, vertex.label=NA, edge.arrow.width=0.3, edge.arrow.curve=0.5)</code></pre>
<p><img src="figure/Networks_HW3.Rmd/unnamed-chunk-5-1.png" width="1056" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="problem-4.-are-the-module-assignments-the-same-as-in-the-unweighted-network" class="section level2">
<h2>Problem 4. Are the module assignments the same as in the unweighted network?</h2>
<pre class="r"><code>par(mfrow=c(1,2))
plot(ches_web_unweighted, vertex.color=V(ches_web_unweighted)$color, vertex.size=10, vertex.label=NA, edge.arrow.width=0.3, edge.arrow.curve=0.5, main=&quot;Unweighted&quot;)

plot(as.undirected(ches_web), vertex.color=V(ches_web)$color_wt, vertex.size=5, vertex.label=NA, edge.arrow.width=0.3, edge.arrow.curve=0.5, main=&quot;Weighted&quot;)</code></pre>
<p><img src="figure/Networks_HW3.Rmd/unnamed-chunk-6-1.png" width="1056" style="display: block; margin: auto;" /> No, they are not the same. The number of modules is also different.</p>
<p>Directed networks We will not touch upon directed networks in the context of modularity maximization, although there is a development for it by Guimera et al (2007). The description of the sofware and the associated papers is here. The problem is that it is not available in an easy package, so you will have to hack your way through this. In fact, for directed networks we recommend using Infomap.</p>
</div>
<div id="bipartite-networks" class="section level2">
<h2>3. Bipartite networks</h2>
<p>The difference between bipartite and unipartite networks lies in the “null” term of the modularity function, which should account for the fact that edges cannot be expected between nodes of the same set. This is well explained in (Guimera et al. 2007; Barber 2007) and reviewed in the context of ecology by Thebault (2013). Each of these have their own software associated with their papers.<br />
</p>
<p>But for the sake of this exercise we are looking for an implementation to optimize modularity maximization which will be readily available, and also will allow us to analyze batches of networks (for testing patterns against shuffled networks). The bipartite package has a recent implementation of Stephen Beckett’s DIRTLPAwb+ algorithm (Beckett 2016). This algorithm maximizes a modularity function for weighted bipartite networks (Dorman &amp; Strauss 2014), which is a recent extention of Barber’s (2007) method and is reduced to it if the input is a binary network. All this can be a bit confusing so it is strongly suggested to read these papers if you are about to apply these methods for community detection in your research.</p>
<pre class="r"><code>mod &lt;- computeModules(memmott1999)
slotNames(mod) # see ?moduleWeb for details</code></pre>
<pre><code>[1] &quot;originalWeb&quot; &quot;moduleWeb&quot;   &quot;orderA&quot;      &quot;orderB&quot;      &quot;modules&quot;    
[6] &quot;likelihood&quot; </code></pre>
<pre class="r"><code>mod@likelihood # This is the value of the modularity function Q. NOTICE THE @ SIGN (instead of $).</code></pre>
<pre><code>[1] 0.3039558</code></pre>
<pre class="r"><code># 0.3042993

module_list &lt;- listModuleInformation(mod) # The output is rather cumbersome...
par(mfrow=c(1,1))
plotModuleWeb(mod)</code></pre>
<p><img src="figure/Networks_HW3.Rmd/unnamed-chunk-7-1.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code>module_list &lt;- module_list[[2]] # let&#39;s look at the modules. The first element in the list is the whole network, so start with 2
for (i in 1:2){ # Show the two first modules.
  message(paste(&#39;Module:&#39;,i))
  print(module_list[[i]])
}</code></pre>
<pre><code>[[1]]
[1] &quot;Euphrasia.officinalis&quot;

[[2]]
[1] &quot;Platycheirus.albimanus&quot;

[[1]]
[1] &quot;Lotus.corniculatus&quot;  &quot;Centaurea.nigra&quot;     &quot;Knautia.arvensis&quot;   
[4] &quot;Lathyrus.pratensis&quot;  &quot;Trifolium.pratense&quot;  &quot;Angelica.sylvestris&quot;

[[2]]
 [1] &quot;Coleoptera.spec1&quot;      &quot;Curculionidae.spec1&quot;   &quot;Conipidae.spec1&quot;      
 [4] &quot;Diptera.spec14&quot;        &quot;Diptera.spec16&quot;        &quot;Diptera.spec25&quot;       
 [7] &quot;Eristalis.tenax&quot;       &quot;Rhingia.campestris&quot;    &quot;Bombus.lapidarius&quot;    
[10] &quot;Bombus.muscorum&quot;       &quot;Bombus.pascuorum&quot;      &quot;Bombus.terrestris&quot;    
[13] &quot;Psithyrus.spec1&quot;       &quot;Apis.mellifera&quot;        &quot;Polyommatus.icarus&quot;   
[16] &quot;Maniola.jurtina&quot;       &quot;Thymelicus.sylvestris&quot;</code></pre>
<p>This list data structure is horrible for analysis. This code transforms it to a data frame:</p>
<pre class="r"><code># Transform the lists to data frames
m &lt;- length(module_list) # Number of modules
mod_plants &lt;- unlist(module_list, recursive = F)[seq(1,2*m,2)] # Assignments of plants
names(mod_plants) &lt;- 1:m
mod_pollinators &lt;- unlist(module_list, recursive = F)[seq(2,2*m,2)] # Assignments of pollinators
names(mod_pollinators) &lt;- 1:m
tmp_plants &lt;- data.frame(module = rep(names(mod_plants), sapply(mod_plants, length)), species = unlist(mod_plants), type=&#39;Plants&#39;)
tmp_poillnators &lt;- data.frame(module = rep(names(mod_pollinators), sapply(mod_pollinators, length)), species = unlist(mod_pollinators), type=&#39;Pollinators&#39;)
# Make one data frame
(module_assignments &lt;- rbind(tmp_plants,tmp_poillnators))</code></pre>
<pre><code>     module                  species        type
1         1    Euphrasia.officinalis      Plants
21        2       Lotus.corniculatus      Plants
22        2          Centaurea.nigra      Plants
23        2         Knautia.arvensis      Plants
24        2       Lathyrus.pratensis      Plants
25        2       Trifolium.pratense      Plants
26        2      Angelica.sylvestris      Plants
31        3    Agrimonium.eupatorium      Plants
32        3           Plantago.major      Plants
41        4     Leontodon.autumnalis      Plants
42        4        Medicago.lupulina      Plants
43        4     Hypochaeris.radicata      Plants
44        4        Linum.catharticum      Plants
45        4     Convolvulus.arvensis      Plants
46        4      Leontodon.saxatilis      Plants
47        4         Senecio.jacobaea      Plants
48        4       Leontodon.hispidus      Plants
49        4        Crepis.capillaris      Plants
51        5         Rubus.fruticosus      Plants
52        5            Daucus.carota      Plants
61        6         Aethusa.cynapium      Plants
62        6    Eupatorium.cannabinum      Plants
63        6         Clematis.vitalba      Plants
64        6  Chamerion.angustifolium      Plants
65        6         Torilis.japonica      Plants
11        1   Platycheirus.albimanus Pollinators
218       2         Coleoptera.spec1 Pollinators
221       2      Curculionidae.spec1 Pollinators
231       2          Conipidae.spec1 Pollinators
241       2           Diptera.spec14 Pollinators
251       2           Diptera.spec16 Pollinators
261       2           Diptera.spec25 Pollinators
27        2          Eristalis.tenax Pollinators
28        2       Rhingia.campestris Pollinators
29        2        Bombus.lapidarius Pollinators
210       2          Bombus.muscorum Pollinators
211       2         Bombus.pascuorum Pollinators
212       2        Bombus.terrestris Pollinators
213       2          Psithyrus.spec1 Pollinators
214       2           Apis.mellifera Pollinators
215       2       Polyommatus.icarus Pollinators
216       2          Maniola.jurtina Pollinators
217       2    Thymelicus.sylvestris Pollinators
311       3     Melanostoma.mellinum Pollinators
321       3      Melanostoma.scalare Pollinators
33        3   Platycheirus.clypeatus Pollinators
419       4         Coleoptera.spec2 Pollinators
421       4         Coleoptera.spec3 Pollinators
431       4         Coleoptera.spec4 Pollinators
441       4         Coleoptera.spec5 Pollinators
451       4         Coleoptera.spec6 Pollinators
461       4         Coleoptera.spec7 Pollinators
471       4           Diptera.spec10 Pollinators
481       4           Diptera.spec17 Pollinators
491       4           Diptera.spec18 Pollinators
410       4           Diptera.spec22 Pollinators
411       4           Diptera.spec23 Pollinators
412       4    Episyrphus.arbustorum Pollinators
413       4      Helophilus.pendulus Pollinators
414       4    Sphaerophoria.scripta Pollinators
415       4            solitary.bees Pollinators
416       4         Pieris.brassicae Pollinators
417       4      Incurvariidae.spec1 Pollinators
418       4           Aglais.urticae Pollinators
5110      5            Diptera.spec1 Pollinators
528       5            Diptera.spec3 Pollinators
53        5            Diptera.spec4 Pollinators
54        5            Diptera.spec5 Pollinators
55        5            Diptera.spec6 Pollinators
56        5   Scatophaga.stercoraria Pollinators
57        5            Diptera.spec7 Pollinators
58        5            Diptera.spec8 Pollinators
59        5           Diptera.spec11 Pollinators
510       5           Diptera.spec12 Pollinators
511       5           Diptera.spec13 Pollinators
512       5           Diptera.spec15 Pollinators
513       5           Diptera.spec19 Pollinators
514       5           Diptera.spec20 Pollinators
515       5           Diptera.spec21 Pollinators
516       5        Tephretidae.spec1 Pollinators
517       5           Diptera.spec26 Pollinators
518       5           Diptera.spec27 Pollinators
519       5    Chrysotoxum.bicinctum Pollinators
520       5     Metasyrphus.corollae Pollinators
521       5    Platycheirus.scutatus Pollinators
522       5          Syritta.pipiens Pollinators
523       5          Syrphus.ribesii Pollinators
524       5      Syrphus.vitripennis Pollinators
525       5 Xanthogramma.pedissequum Pollinators
526       5               Parasitica Pollinators
527       5           Symphyta.spec1 Pollinators
614       6        Cantharidae.spec1 Pollinators
621       6            Diptera.spec2 Pollinators
631       6            Diptera.spec9 Pollinators
641       6   Eriothrix.rufomaculata Pollinators
651       6           Diptera.spec24 Pollinators
66        6     Episyrphus.balteatus Pollinators
67        6       Eristalis.pertinax Pollinators
68        6   Helophilus.trivittatus Pollinators
69        6    Meliscaeva.auricollis Pollinators
610       6          Scaeva.pyrastri Pollinators
611       6         Formicidae.spec1 Pollinators
612       6           Symphyta.spec2 Pollinators
613       6          Pyonia.tithonus Pollinators</code></pre>
</div>
<div id="problem-5.-try-to-calculate-modularity-for-the-binary-version-of-this-web.-how-do-the-results-differ" class="section level2">
<h2>Problem 5. Try to calculate modularity for the binary version of this web. How do the results differ?</h2>
<pre class="r"><code>class(memmott1999)</code></pre>
<pre><code>[1] &quot;matrix&quot; &quot;array&quot; </code></pre>
<pre class="r"><code>dim(memmott1999)</code></pre>
<pre><code>[1] 25 79</code></pre>
<pre class="r"><code># conver to binary matrix
sum(memmott1999!=0)</code></pre>
<pre><code>[1] 299</code></pre>
<pre class="r"><code>mem_binary &lt;- ifelse(memmott1999&gt;0, 1, 0)
sum(mem_binary!=0) # conversion worked well</code></pre>
<pre><code>[1] 299</code></pre>
<pre class="r"><code>mod_b &lt;- computeModules(mem_binary)
slotNames(mod_b) # see ?moduleWeb for details</code></pre>
<pre><code>[1] &quot;originalWeb&quot; &quot;moduleWeb&quot;   &quot;orderA&quot;      &quot;orderB&quot;      &quot;modules&quot;    
[6] &quot;likelihood&quot; </code></pre>
<pre class="r"><code>mod_b@likelihood # This is the value of the modularity function Q. NOTICE THE @ SIGN (instead of $).</code></pre>
<pre><code>[1] 0.3240903</code></pre>
<pre class="r"><code># 0.3284303

module_list &lt;- listModuleInformation(mod_b) # The output is rather cumbersome...
par(mfrow=c(1,1))
plotModuleWeb(mod_b)</code></pre>
<p><img src="figure/Networks_HW3.Rmd/unnamed-chunk-9-1.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code>module_list &lt;- module_list[[2]] # let&#39;s look at the modules. The first element in the list is the whole network, so start with 2
for (i in 1:2){ # Show the two first modules.
  message(paste(&#39;Module:&#39;,i))
  print(module_list[[i]])
}</code></pre>
<pre><code>[[1]]
[1] &quot;Lotus.corniculatus&quot; &quot;Centaurea.nigra&quot;    &quot;Knautia.arvensis&quot;  
[4] &quot;Trifolium.pratense&quot;

[[2]]
 [1] &quot;Coleoptera.spec1&quot;      &quot;Curculionidae.spec1&quot;   &quot;Diptera.spec7&quot;        
 [4] &quot;Diptera.spec16&quot;        &quot;Eristalis.tenax&quot;       &quot;Bombus.lapidarius&quot;    
 [7] &quot;Bombus.muscorum&quot;       &quot;Bombus.pascuorum&quot;      &quot;Bombus.terrestris&quot;    
[10] &quot;Psithyrus.spec1&quot;       &quot;Apis.mellifera&quot;        &quot;Polyommatus.icarus&quot;   
[13] &quot;Pyonia.tithonus&quot;       &quot;Thymelicus.sylvestris&quot;

[[1]]
[1] &quot;Plantago.major&quot;

[[2]]
[1] &quot;Platycheirus.clypeatus&quot;</code></pre>
<pre class="r"><code># This list data structure is horrible for analysis. This code transforms it to a data frame:

# Transform the lists to data frames
m &lt;- length(module_list) # Number of modules
mod_plants &lt;- unlist(module_list, recursive = F)[seq(1,2*m,2)] # Assignments of plants
names(mod_plants) &lt;- 1:m
mod_pollinators &lt;- unlist(module_list, recursive = F)[seq(2,2*m,2)] # Assignments of pollinators
names(mod_pollinators) &lt;- 1:m
tmp_plants &lt;- data.frame(module = rep(names(mod_plants), sapply(mod_plants, length)), species = unlist(mod_plants), type=&#39;Plants&#39;)
tmp_poillnators &lt;- data.frame(module = rep(names(mod_pollinators), sapply(mod_pollinators, length)), species = unlist(mod_pollinators), type=&#39;Pollinators&#39;)
# Make one data frame
(module_assignments2 &lt;- rbind(tmp_plants,tmp_poillnators))</code></pre>
<pre><code>    module                  species        type
11       1       Lotus.corniculatus      Plants
12       1          Centaurea.nigra      Plants
13       1         Knautia.arvensis      Plants
14       1       Trifolium.pratense      Plants
2        2           Plantago.major      Plants
31       3    Agrimonium.eupatorium      Plants
32       3        Medicago.lupulina      Plants
33       3     Hypochaeris.radicata      Plants
34       3        Linum.catharticum      Plants
35       3     Convolvulus.arvensis      Plants
36       3      Leontodon.saxatilis      Plants
37       3         Clematis.vitalba      Plants
38       3         Senecio.jacobaea      Plants
41       4     Leontodon.autumnalis      Plants
42       4         Rubus.fruticosus      Plants
43       4    Euphrasia.officinalis      Plants
44       4       Leontodon.hispidus      Plants
45       4      Angelica.sylvestris      Plants
51       5    Eupatorium.cannabinum      Plants
52       5         Torilis.japonica      Plants
6        6            Daucus.carota      Plants
71       7       Lathyrus.pratensis      Plants
72       7  Chamerion.angustifolium      Plants
73       7        Crepis.capillaris      Plants
8        8         Aethusa.cynapium      Plants
115      1         Coleoptera.spec1 Pollinators
121      1      Curculionidae.spec1 Pollinators
131      1            Diptera.spec7 Pollinators
141      1           Diptera.spec16 Pollinators
15       1          Eristalis.tenax Pollinators
16       1        Bombus.lapidarius Pollinators
17       1          Bombus.muscorum Pollinators
18       1         Bombus.pascuorum Pollinators
19       1        Bombus.terrestris Pollinators
110      1          Psithyrus.spec1 Pollinators
111      1           Apis.mellifera Pollinators
112      1       Polyommatus.icarus Pollinators
113      1          Pyonia.tithonus Pollinators
114      1    Thymelicus.sylvestris Pollinators
21       2   Platycheirus.clypeatus Pollinators
312      3         Coleoptera.spec3 Pollinators
321      3         Coleoptera.spec6 Pollinators
331      3   Eriothrix.rufomaculata Pollinators
341      3           Diptera.spec22 Pollinators
351      3           Diptera.spec23 Pollinators
361      3     Episyrphus.balteatus Pollinators
371      3     Melanostoma.mellinum Pollinators
381      3     Metasyrphus.corollae Pollinators
39       3    Sphaerophoria.scripta Pollinators
310      3            solitary.bees Pollinators
311      3         Pieris.brassicae Pollinators
417      4         Coleoptera.spec2 Pollinators
421      4         Coleoptera.spec4 Pollinators
431      4         Coleoptera.spec5 Pollinators
441      4         Coleoptera.spec7 Pollinators
451      4           Diptera.spec10 Pollinators
46       4           Diptera.spec12 Pollinators
47       4           Diptera.spec14 Pollinators
48       4           Diptera.spec17 Pollinators
49       4           Diptera.spec18 Pollinators
410      4           Diptera.spec25 Pollinators
411      4           Diptera.spec27 Pollinators
412      4    Episyrphus.arbustorum Pollinators
413      4      Helophilus.pendulus Pollinators
414      4   Platycheirus.albimanus Pollinators
415      4          Syritta.pipiens Pollinators
416      4               Parasitica Pollinators
513      5        Cantharidae.spec1 Pollinators
521      5            Diptera.spec2 Pollinators
53       5            Diptera.spec4 Pollinators
54       5          Conipidae.spec1 Pollinators
55       5            Diptera.spec8 Pollinators
56       5           Diptera.spec24 Pollinators
57       5       Eristalis.pertinax Pollinators
58       5   Helophilus.trivittatus Pollinators
59       5          Scaeva.pyrastri Pollinators
510      5         Formicidae.spec1 Pollinators
511      5           Symphyta.spec2 Pollinators
512      5           Aglais.urticae Pollinators
61       6            Diptera.spec1 Pollinators
62       6            Diptera.spec3 Pollinators
63       6   Scatophaga.stercoraria Pollinators
64       6            Diptera.spec9 Pollinators
65       6           Diptera.spec11 Pollinators
66       6           Diptera.spec13 Pollinators
67       6           Diptera.spec15 Pollinators
68       6           Diptera.spec20 Pollinators
69       6        Tephretidae.spec1 Pollinators
610      6           Diptera.spec26 Pollinators
611      6    Chrysotoxum.bicinctum Pollinators
612      6    Platycheirus.scutatus Pollinators
613      6          Syrphus.ribesii Pollinators
614      6      Syrphus.vitripennis Pollinators
615      6 Xanthogramma.pedissequum Pollinators
616      6      Incurvariidae.spec1 Pollinators
617      6          Maniola.jurtina Pollinators
711      7            Diptera.spec5 Pollinators
721      7           Diptera.spec21 Pollinators
731      7      Melanostoma.scalare Pollinators
74       7       Rhingia.campestris Pollinators
81       8            Diptera.spec6 Pollinators
82       8           Diptera.spec19 Pollinators
83       8    Meliscaeva.auricollis Pollinators
84       8           Symphyta.spec1 Pollinators</code></pre>
<pre class="r"><code>par(mfrow=c(1,2))
plotModuleWeb(mod)
plotModuleWeb(mod_b)</code></pre>
<p><img src="figure/Networks_HW3.Rmd/unnamed-chunk-10-1.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code>par(mfrow=c(1,1))

# module_assignments
# module_assignments2

module_assignments %&gt;% filter(type==&quot;Plants&quot;)</code></pre>
<pre><code>   module                 species   type
1       1   Euphrasia.officinalis Plants
21      2      Lotus.corniculatus Plants
22      2         Centaurea.nigra Plants
23      2        Knautia.arvensis Plants
24      2      Lathyrus.pratensis Plants
25      2      Trifolium.pratense Plants
26      2     Angelica.sylvestris Plants
31      3   Agrimonium.eupatorium Plants
32      3          Plantago.major Plants
41      4    Leontodon.autumnalis Plants
42      4       Medicago.lupulina Plants
43      4    Hypochaeris.radicata Plants
44      4       Linum.catharticum Plants
45      4    Convolvulus.arvensis Plants
46      4     Leontodon.saxatilis Plants
47      4        Senecio.jacobaea Plants
48      4      Leontodon.hispidus Plants
49      4       Crepis.capillaris Plants
51      5        Rubus.fruticosus Plants
52      5           Daucus.carota Plants
61      6        Aethusa.cynapium Plants
62      6   Eupatorium.cannabinum Plants
63      6        Clematis.vitalba Plants
64      6 Chamerion.angustifolium Plants
65      6        Torilis.japonica Plants</code></pre>
<pre class="r"><code>module_assignments2 %&gt;% filter(type==&quot;Plants&quot;)</code></pre>
<pre><code>   module                 species   type
11      1      Lotus.corniculatus Plants
12      1         Centaurea.nigra Plants
13      1        Knautia.arvensis Plants
14      1      Trifolium.pratense Plants
2       2          Plantago.major Plants
31      3   Agrimonium.eupatorium Plants
32      3       Medicago.lupulina Plants
33      3    Hypochaeris.radicata Plants
34      3       Linum.catharticum Plants
35      3    Convolvulus.arvensis Plants
36      3     Leontodon.saxatilis Plants
37      3        Clematis.vitalba Plants
38      3        Senecio.jacobaea Plants
41      4    Leontodon.autumnalis Plants
42      4        Rubus.fruticosus Plants
43      4   Euphrasia.officinalis Plants
44      4      Leontodon.hispidus Plants
45      4     Angelica.sylvestris Plants
51      5   Eupatorium.cannabinum Plants
52      5        Torilis.japonica Plants
6       6           Daucus.carota Plants
71      7      Lathyrus.pratensis Plants
72      7 Chamerion.angustifolium Plants
73      7       Crepis.capillaris Plants
8       8        Aethusa.cynapium Plants</code></pre>
<ol style="list-style-type: decimal">
<li>The modularity Q increased about 10% with binary matrix: from 0.3042993 to 0.3284303</li>
<li>The assignment of the nodes to the module is also slightly different. For example, for plants the number of modules increased by 1 (5 -&gt; 6) in binary matrix. In addition, the biggest module’s size increased to 11 from 9.</li>
</ol>
</div>
<div id="problem-6.-can-you-project-the-network-and-calculate-modularity-in-each-of-the-projections-do-plants-that-cluster-together-in-the-projection-also-cluster-together-in-the-bipartite-version-is-there-an-difference-in-the-ecological-interpretation-between-these-two-scenarios" class="section level2">
<h2>Problem 6. Can you project the network and calculate modularity in each of the projections? Do plants that cluster together in the projection also cluster together in the bipartite version? Is there an difference in the ecological interpretation between these two scenarios?</h2>
<pre class="r"><code># lower = g x g matrix for g plants / higher = n x n matrix for n pollinators
plants_projected &lt;- as.one.mode(memmott1999, project = &#39;lower&#39;)
dim(plants_projected)</code></pre>
<pre><code>[1] 25 25</code></pre>
<pre class="r"><code># plants_projected

# project to pollinators
# pollinator_projected &lt;- as.one.mode(memmott1999, project = &#39;higher&#39;)
# dim(pollinator_projected)

rownames(plants_projected)</code></pre>
<pre><code> [1] &quot;Agrimonium.eupatorium&quot;   &quot;Leontodon.autumnalis&quot;   
 [3] &quot;Lotus.corniculatus&quot;      &quot;Medicago.lupulina&quot;      
 [5] &quot;Rubus.fruticosus&quot;        &quot;Hypochaeris.radicata&quot;   
 [7] &quot;Centaurea.nigra&quot;         &quot;Euphrasia.officinalis&quot;  
 [9] &quot;Linum.catharticum&quot;       &quot;Convolvulus.arvensis&quot;   
[11] &quot;Knautia.arvensis&quot;        &quot;Aethusa.cynapium&quot;       
[13] &quot;Eupatorium.cannabinum&quot;   &quot;Plantago.major&quot;         
[15] &quot;Leontodon.saxatilis&quot;     &quot;Lathyrus.pratensis&quot;     
[17] &quot;Clematis.vitalba&quot;        &quot;Senecio.jacobaea&quot;       
[19] &quot;Trifolium.pratense&quot;      &quot;Chamerion.angustifolium&quot;
[21] &quot;Leontodon.hispidus&quot;      &quot;Crepis.capillaris&quot;      
[23] &quot;Torilis.japonica&quot;        &quot;Angelica.sylvestris&quot;    
[25] &quot;Daucus.carota&quot;          </code></pre>
<pre class="r"><code>colnames(plants_projected)</code></pre>
<pre><code> [1] &quot;Agrimonium.eupatorium&quot;   &quot;Leontodon.autumnalis&quot;   
 [3] &quot;Lotus.corniculatus&quot;      &quot;Medicago.lupulina&quot;      
 [5] &quot;Rubus.fruticosus&quot;        &quot;Hypochaeris.radicata&quot;   
 [7] &quot;Centaurea.nigra&quot;         &quot;Euphrasia.officinalis&quot;  
 [9] &quot;Linum.catharticum&quot;       &quot;Convolvulus.arvensis&quot;   
[11] &quot;Knautia.arvensis&quot;        &quot;Aethusa.cynapium&quot;       
[13] &quot;Eupatorium.cannabinum&quot;   &quot;Plantago.major&quot;         
[15] &quot;Leontodon.saxatilis&quot;     &quot;Lathyrus.pratensis&quot;     
[17] &quot;Clematis.vitalba&quot;        &quot;Senecio.jacobaea&quot;       
[19] &quot;Trifolium.pratense&quot;      &quot;Chamerion.angustifolium&quot;
[21] &quot;Leontodon.hispidus&quot;      &quot;Crepis.capillaris&quot;      
[23] &quot;Torilis.japonica&quot;        &quot;Angelica.sylvestris&quot;    
[25] &quot;Daucus.carota&quot;          </code></pre>
<pre class="r"><code>isSymmetric.matrix(plants_projected) # symmetric, therefore undirected</code></pre>
<pre><code>[1] TRUE</code></pre>
<pre class="r"><code>g_plant &lt;- igraph::graph.adjacency(plants_projected, mode = &#39;undirected&#39;)
par(mar=c(0,0,0,0))
plot(g_plant, vertex.size=6, edge.curved=0.5)</code></pre>
<p><img src="figure/Networks_HW3.Rmd/unnamed-chunk-11-1.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Detect communities, note the as.undirected command
E(g_plant)$weight &lt;- 1

# implementing Louvain method
cl &lt;- cluster_louvain(g_plant) # Can also use the weights = NULL argument
class(cl) # the result is of class communities</code></pre>
<pre><code>[1] &quot;communities&quot;</code></pre>
<pre class="r"><code># module membership &amp; visualization
module_membership &lt;- membership(cl)
cols &lt;- data.frame(mem=unique(module_membership),col=c(&#39;blue&#39;,&#39;red&#39;))

V(g_plant)$module_membership &lt;- module_membership
V(g_plant)$color &lt;- cols$col[match(V(g_plant)$module_membership, cols$mem)]
plot(g_plant, vertex.color=V(g_plant)$color, vertex.size=10, edge.arrow.width=0.3, edge.arrow.curve=0.5)</code></pre>
<p><img src="figure/Networks_HW3.Rmd/unnamed-chunk-11-2.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code># compare membership
# (1) module membership for bipartite version
mod_bipartite &lt;- module_assignments %&gt;% filter(type==&quot;Plants&quot;)
table(mod_bipartite$module)</code></pre>
<pre><code>
1 2 3 4 5 6 
1 6 2 9 2 5 </code></pre>
<pre class="r"><code># (2) module membership for unipartite version
table(module_membership)</code></pre>
<pre><code>module_membership
 1  2 
21  4 </code></pre>
<pre class="r"><code># look for discrepencies
# (1) Module that Leontodon.autumnalis is in for bipartite case
Leon_mod &lt;- mod_bipartite %&gt;% filter(species==&#39;Leontodon.autumnalis&#39;)
mem_bi &lt;- mod_bipartite %&gt;% filter(module==Leon_mod$module) %&gt;% select(species) %&gt;% unlist()

# (2) Module that Leontodon.autumnalis is in for unipartite modules
mod_unipartite &lt;- data.frame(species=names(module_membership),module=as.numeric(module_membership))
Leon_mod_uni &lt;- mod_unipartite %&gt;% filter(species==&#39;Leontodon.autumnalis&#39;) # Leontodon.autumnalis is in module 3
mem_uni &lt;- mod_unipartite %&gt;% filter(module==Leon_mod_uni$module) %&gt;% select(species) %&gt;% unlist() 

# see difference
setdiff(mem_bi,mem_uni)</code></pre>
<pre><code>[1] &quot;Leontodon.hispidus&quot;</code></pre>
<pre class="r"><code>setdiff(mem_uni,mem_bi)</code></pre>
<pre><code> [1] &quot;Agrimonium.eupatorium&quot;   &quot;Lotus.corniculatus&quot;     
 [3] &quot;Rubus.fruticosus&quot;        &quot;Centaurea.nigra&quot;        
 [5] &quot;Euphrasia.officinalis&quot;   &quot;Knautia.arvensis&quot;       
 [7] &quot;Aethusa.cynapium&quot;        &quot;Plantago.major&quot;         
 [9] &quot;Lathyrus.pratensis&quot;      &quot;Clematis.vitalba&quot;       
[11] &quot;Trifolium.pratense&quot;      &quot;Chamerion.angustifolium&quot;
[13] &quot;Angelica.sylvestris&quot;    </code></pre>
<ol style="list-style-type: decimal">
<li>The number of modules is different between bipartite and unipartite modules</li>
<li>For example for the module that Leontodon.autumnalis is in, bipartite module is smaller than that of unipartite version. They are not the exact subset of one another. So we can say that not all plants that cluster together in the projection also cluster together in the bipartite version.</li>
<li>There is a difference in the ecological interpretation between these two scenarios. We lose information when we project the adjacency matrix into unipartite networks. Therefore, when creating modules, we no longer take the pollinator information into account (directly), which is ecologically different than having the pollinator information to directly maximize modularity Q. This is why the unipartite network’s modular structure becomes much simpler(less number of modules) than that of bipartite version.</li>
</ol>
</div>
<div id="problem-7.-find-another-data-set-that-interests-you-personally-in-which-you-could-hypothesize-the-existence-of-communities.-explain-why-this-hypothesis-is-relevant-for-this-data-set.-analyze-for-communities-with-a-method-from-the-material-above.-do-the-results-support-the-hypothesis-e.g.-when-you-examine-the-nodes-in-each-module." class="section level2">
<h2>Problem 7. Find another data set that interests you personally in which you could hypothesize the existence of communities. Explain why this hypothesis is relevant for this data set. Analyze for communities, with a method from the material above. Do the results support the hypothesis (e.g., when you examine the nodes in each module).</h2>
<p>I would be interested in the modularity of fungal-bacterial network of rice seed. Hypothesis is that fungi and bacteria would not exist as separate module in the network. microbiome.(<a href="https://microbiomejournal.biomedcentral.com/articles/10.1186/s40168-020-00805-0" class="uri">https://microbiomejournal.biomedcentral.com/articles/10.1186/s40168-020-00805-0</a>)</p>
<pre class="r"><code># domesticated rice seed microbiome
domestic_links &lt;- read.csv(&#39;data/2_0.3_node_dom.css.ss.5.tsv&#39;,sep=&quot;\t&quot;, header=T)
b_domestic_links &lt;- read.csv(&#39;data/5_0.3_edge_dom.phy.ss.5.tsv&#39;,sep=&quot;\t&quot;, header=T)
f_domestic_links &lt;- read.csv(&#39;data/8_0.3_edge_dom.fun.ss.5.tsv&#39;,sep=&quot;\t&quot;, header=T)

# wild rice seed microbiome
wild_links &lt;- read.csv(&#39;data/3_0.3_edge_wil.css.ss.5.tsv&#39;,sep=&quot;\t&quot;, header=T)
b_wild_links &lt;- read.csv(&#39;data/6_0.3_edge_wil.phy.ss.5.tsv&#39;,sep=&quot;\t&quot;, header=T) # bacteria
f_wild_links &lt;- read.csv(&#39;data/9_0.3_edge_wil.fun.ss.5.tsv&#39;,sep=&quot;\t&quot;, header=T) # fungi

# microbial network of wild rice seed endophytes
wild_web &lt;- graph.data.frame(wild_links, directed = F)
b_wild_web &lt;- graph.data.frame(b_wild_links, directed = F) # bacteria
f_wild_web &lt;- graph.data.frame(f_wild_links, directed = F) # fungi

plot(wild_web, vertex.size=5, vertex.label=NA, main=&quot;Bacteria &amp; Fungi-Wild rice&quot;)</code></pre>
<p><img src="figure/Networks_HW3.Rmd/unnamed-chunk-12-1.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code>plot(b_wild_web, vertex.size=5, vertex.label=NA, main=&quot;Bacteria-Wild rice&quot;)</code></pre>
<p><img src="figure/Networks_HW3.Rmd/unnamed-chunk-12-2.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code>plot(f_wild_web, vertex.size=5, vertex.label=NA, main=&quot;Fungi-Wild rice&quot;)</code></pre>
<p><img src="figure/Networks_HW3.Rmd/unnamed-chunk-12-3.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Detect communities, note the as.undirected command
wild_unweighted &lt;- wild_web
wild_unweighted &lt;- as.undirected(wild_unweighted)
E(wild_unweighted)$weight &lt;- 1

# implementing Louvain method
cl &lt;- cluster_louvain(wild_unweighted) # Can also use the weights = NULL argument
class(cl) # the result is of class communities</code></pre>
<pre><code>[1] &quot;communities&quot;</code></pre>
<pre class="r"><code># module membership &amp; visualization
module_membership &lt;- membership(cl)
table(module_membership)</code></pre>
<pre><code>module_membership
 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 
22  5  8 22 10 14 29 44  2  3  4 18 15  3 21 19 23 31 33 15 20 </code></pre>
<pre class="r"><code>my_color_collection &lt;- c(
  &quot;#CBD588&quot;, &quot;#5F7FC7&quot;, &quot;orange&quot;, &quot;#AD6F3B&quot;, &quot;#673770&quot;, 
  &quot;#D14285&quot;, &quot;#652926&quot;, &quot;#C84248&quot;, &quot;#8569D5&quot;, &quot;#5E738F&quot;,
  &quot;#D1A33D&quot;, &quot;#8A7C64&quot;, &quot;#599861&quot;,&quot;#616163&quot;, &quot;#FFCDB2&quot;,
  &quot;#6D9F71&quot;, &quot;#242F40&quot;,
   &quot;#CCA43B&quot;, &quot;#F92A82&quot;, &quot;#ED7B84&quot;, &quot;#7EB77F&quot;, 
  &quot;#DEC4A1&quot;, &quot;#E5D1D0&quot;, &#39;#0E8482&#39;, &#39;#C9DAEA&#39;, &#39;#337357&#39;, 
  &#39;#95C623&#39;, &#39;#E55812&#39;, &#39;#04471C&#39;, &#39;#F2D7EE&#39;, &#39;#D3BCC0&#39;, 
  &#39;#A5668B&#39;, &#39;#69306D&#39;, &#39;#0E103D&#39;, &#39;#1A535C&#39;, &#39;#4ECDC4&#39;, 
  &#39;#F7FFF7&#39;, &#39;#FF6B6B&#39;, &#39;#FFE66D&#39;, &#39;#6699CC&#39;, &#39;#FFF275&#39;, 
  &#39;#FF8C42&#39;, &#39;#FF3C38&#39;, &#39;#A23E48&#39;, &#39;#000000&#39;, &#39;#CF5C36&#39;, 
  &#39;#EEE5E9&#39;, &#39;#7C7C7C&#39;, &#39;#EFC88B&#39;, &#39;#2E5266&#39;, &#39;#6E8898&#39;, 
  &#39;#9FB1BC&#39;, &#39;#D3D0CB&#39;, &#39;#E2C044&#39;, &#39;#5BC0EB&#39;, &#39;#FDE74C&#39;, 
  &#39;#9BC53D&#39;, &#39;#E55934&#39;, &#39;#FA7921&#39;, &quot;#CD9BCD&quot;, &quot;#508578&quot;, &quot;#DA5724&quot;)

# color
cols &lt;- data.frame(mem=unique(module_membership), col= my_color_collection[1:length(unique(module_membership))])
V(wild_unweighted)$module_membership &lt;- module_membership
V(wild_unweighted)$color &lt;- cols$col[match(V(wild_unweighted)$module_membership, cols$mem)]

# shape: triangle fungi / circle bacteria
V(wild_unweighted)$shape &lt;- ifelse(substr(V(wild_unweighted)$name,1,1)==&quot;B&quot;,&quot;circle&quot;,&quot;csquare&quot;)

# plot network
plot(wild_unweighted, vertex.color=V(wild_unweighted)$color, vertex.size=6, edge.arrow.width=0.3, edge.arrow.curve=0.5, vertex.shape=V(wild_unweighted)$shape, vertex.label=NA)</code></pre>
<p><img src="figure/Networks_HW3.Rmd/unnamed-chunk-12-4.png" width="1056" style="display: block; margin: auto;" /> Circle is bacteria and square is fungi. We can see that square and circle coexist in each module.</p>
</div>
<div id="references" class="section level2">
<h2>4. References</h2>
<p>Barber M. Modularity and community detection in bipartite networks. Physical Review E. 2007;76: 1–9.<br />
Beckett SJ. Improved community detection in weighted bipartite networks. R Soc Open Sci. 2016;3: 140536.<br />
Dormann CF, Strauss R. A method for detecting modules in quantitative bipartite networks. Methods Ecol Evol. 2014;5: 90–98.<br />
Guimerà R, Sales-Pardo M, Amaral LAN. Module identification in bipartite and directed networks. Phys Rev E Stat Nonlin Soft Matter Phys. 2007;76: 036102.<br />
Thébault E. Identifying compartments in presence-absence matrices and bipartite networks: insights into modularity measures. J Biogeogr. 2013;40: 759–768.)<br />
</p>
<p>To go deeper into the topic of Community Detection in networks, here are some useful references:<br />
</p>
<p>Fortunato, Santo, and Darko Hric. “Community detection in networks: A user guide.” Physics reports 659 (2016): 1-44.<br />
Fortunato, Santo. “Community detection in graphs.” Physics reports 486, no. 3-5 (2010): 75-174.<br />
</p>
<br>
<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-sessioninfo" data-toggle="collapse" data-target="#workflowr-sessioninfo" style="display: block;">
<span class="glyphicon glyphicon-wrench" aria-hidden="true"></span> Session information
</button>
</p>
<div id="workflowr-sessioninfo" class="collapse">
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>R version 4.0.3 (2020-10-10)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows 10 x64 (build 19042)

Matrix products: default

locale:
[1] LC_COLLATE=English_United States.1252 
[2] LC_CTYPE=English_United States.1252   
[3] LC_MONETARY=English_United States.1252
[4] LC_NUMERIC=C                          
[5] LC_TIME=English_United States.1252    

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] RColorBrewer_1.1-2   ggplot2_3.3.3        dplyr_1.0.4         
 [4] bipartite_2.16       sna_2.6              network_1.16.1      
 [7] statnet.common_4.4.1 vegan_2.5-7          lattice_0.20-41     
[10] permute_0.9-5        igraph_1.2.6         workflowr_1.6.2     

loaded via a namespace (and not attached):
 [1] Rcpp_1.0.5        assertthat_0.2.1  rprojroot_2.0.2   digest_0.6.27    
 [5] utf8_1.1.4        rle_0.9.2         R6_2.5.0          evaluate_0.14    
 [9] coda_0.19-4       spam_2.6-0        highr_0.8         pillar_1.5.1     
[13] rlang_0.4.10      whisker_0.4       jquerylib_0.1.3   Matrix_1.2-18    
[17] rmarkdown_2.7     splines_4.0.3     stringr_1.4.0     munsell_0.5.0    
[21] compiler_4.0.3    httpuv_1.5.4      xfun_0.20         pkgconfig_2.0.3  
[25] mgcv_1.8-33       htmltools_0.5.1.1 tidyselect_1.1.0  tibble_3.0.4     
[29] fansi_0.4.2       withr_2.4.1       crayon_1.4.1      later_1.1.0.1    
[33] MASS_7.3-53       grid_4.0.3        nlme_3.1-149      jsonlite_1.7.2   
[37] gtable_0.3.0      lifecycle_1.0.0   DBI_1.1.1         git2r_0.28.0     
[41] magrittr_2.0.1    scales_1.1.1      stringi_1.5.3     fs_1.5.0         
[45] promises_1.1.1    bslib_0.2.4       ellipsis_0.3.1    vctrs_0.3.6      
[49] generics_0.1.0    tools_4.0.3       glue_1.4.2        purrr_0.3.4      
[53] maps_3.3.0        fields_11.6       parallel_4.0.3    yaml_2.2.1       
[57] colorspace_2.0-0  cluster_2.1.0     dotCall64_1.0-1   knitr_1.31       
[61] sass_0.3.1       </code></pre>
</div>
</div>


<!-- Adjust MathJax settings so that all math formulae are shown using
TeX fonts only; see
http://docs.mathjax.org/en/latest/configuration.html.  This will make
the presentation more consistent at the cost of the webpage sometimes
taking slightly longer to load. Note that this only works because the
footer is added to webpages before the MathJax javascript. -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": { availableFonts: ["TeX"] }
  });
</script>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
