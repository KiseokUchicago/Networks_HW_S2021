<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="KiseokUchicago" />

<meta name="date" content="2021-05-19" />

<title>Networks_HW6</title>

<script src="site_libs/header-attrs-2.7/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<link rel="icon" href="https://github.com/workflowr/workflowr-assets/raw/master/img/reproducible.png">
<!-- Add a small amount of space between sections. -->
<style type="text/css">
div.section {
  padding-top: 12px;
}
</style>



<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>








<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-sm-12 col-md-4 col-lg-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-sm-12 col-md-8 col-lg-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Networks_HW_S2021</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
<li>
  <a href="license.html">License</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/KiseokUchicago/Networks_HW_S2021">
    <span class="fas fa-github"></span>
     
    Source code
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Networks_HW6</h1>
<h4 class="author">KiseokUchicago</h4>
<h4 class="date">2021-05-19</h4>

</div>


<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-report" data-toggle="collapse" data-target="#workflowr-report">
<span class="glyphicon glyphicon-list" aria-hidden="true"></span> workflowr <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span>
</button>
</p>
<div id="workflowr-report" class="collapse">
<ul class="nav nav-tabs">
<li class="active">
<a data-toggle="tab" href="#summary">Summary</a>
</li>
<li>
<a data-toggle="tab" href="#checks"> Checks <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> </a>
</li>
<li>
<a data-toggle="tab" href="#versions">Past versions</a>
</li>
</ul>
<div class="tab-content">
<div id="summary" class="tab-pane fade in active">
<p>
<strong>Last updated:</strong> 2021-05-20
</p>
<p>
<strong>Checks:</strong> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> 7 <span class="glyphicon glyphicon-exclamation-sign text-danger" aria-hidden="true"></span> 0
</p>
<p>
<strong>Knit directory:</strong> <code>Networks_HW_S2021/</code> <span class="glyphicon glyphicon-question-sign" aria-hidden="true" title="This is the local directory in which the code in this file was executed."> </span>
</p>
<p>
This reproducible <a href="http://rmarkdown.rstudio.com">R Markdown</a> analysis was created with <a
  href="https://github.com/jdblischak/workflowr">workflowr</a> (version 1.6.2). The <em>Checks</em> tab describes the reproducibility checks that were applied when the results were created. The <em>Past versions</em> tab lists the development history.
</p>
<hr>
</div>
<div id="checks" class="tab-pane fade">
<div id="workflowr-checks" class="panel-group">
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRMarkdownfilestronguptodate"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>R Markdown file:</strong> up-to-date </a>
</p>
</div>
<div id="strongRMarkdownfilestronguptodate" class="panel-collapse collapse">
<div class="panel-body">
<p>Great! Since the R Markdown file has been committed to the Git repository, you know the exact version of the code that produced these results.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongEnvironmentstrongempty"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Environment:</strong> empty </a>
</p>
</div>
<div id="strongEnvironmentstrongempty" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! The global environment was empty. Objects defined in the global environment can affect the analysis in your R Markdown file in unknown ways. For reproduciblity it’s best to always run the code in an empty environment.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSeedstrongcodesetseed20210409code"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Seed:</strong> <code>set.seed(20210409)</code> </a>
</p>
</div>
<div id="strongSeedstrongcodesetseed20210409code" class="panel-collapse collapse">
<div class="panel-body">
<p>The command <code>set.seed(20210409)</code> was run prior to running the code in the R Markdown file. Setting a seed ensures that any results that rely on randomness, e.g. subsampling or permutations, are reproducible.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSessioninformationstrongrecorded"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Session information:</strong> recorded </a>
</p>
</div>
<div id="strongSessioninformationstrongrecorded" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Recording the operating system, R version, and package versions is critical for reproducibility.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongCachestrongnone"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Cache:</strong> none </a>
</p>
</div>
<div id="strongCachestrongnone" class="panel-collapse collapse">
<div class="panel-body">
<p>Nice! There were no cached chunks for this analysis, so you can be confident that you successfully produced the results during this run.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongFilepathsstrongrelative"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>File paths:</strong> relative </a>
</p>
</div>
<div id="strongFilepathsstrongrelative" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Using relative paths to the files within your workflowr project makes it easier to run your code on other machines.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRepositoryversionstrongahrefhttpsgithubcomKiseokUchicagoNetworksHWS2021treee19e22c125aa8dfc33b4bddefafb4e338463b2d3targetblanke19e22ca"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Repository version:</strong> <a href="https://github.com/KiseokUchicago/Networks_HW_S2021/tree/e19e22c125aa8dfc33b4bddefafb4e338463b2d3" target="_blank">e19e22c</a> </a>
</p>
</div>
<div id="strongRepositoryversionstrongahrefhttpsgithubcomKiseokUchicagoNetworksHWS2021treee19e22c125aa8dfc33b4bddefafb4e338463b2d3targetblanke19e22ca" class="panel-collapse collapse">
<div class="panel-body">
<p>
Great! You are using Git for version control. Tracking code development and connecting the code version to the results is critical for reproducibility.
</p>
<p>
The results in this page were generated with repository version <a href="https://github.com/KiseokUchicago/Networks_HW_S2021/tree/e19e22c125aa8dfc33b4bddefafb4e338463b2d3" target="_blank">e19e22c</a>. See the <em>Past versions</em> tab to see a history of the changes made to the R Markdown and HTML files.
</p>
<p>
Note that you need to be careful to ensure that all relevant files for the analysis have been committed to Git prior to generating the results (you can use <code>wflow_publish</code> or <code>wflow_git_commit</code>). workflowr only checks the R Markdown file, but you know if there are other scripts or data files that it depends on. Below is the status of the Git repository when the results were generated:
</p>
<pre><code>
Ignored files:
    Ignored:    .Rhistory
    Ignored:    .Rproj.user/

Untracked files:
    Untracked:  analysis/infomap
    Untracked:  data/1_0.3_edge_mer.css.ss.5.tsv
    Untracked:  data/1_0.3_node_mer.css.ss.5.tsv
    Untracked:  data/2_0.3_edge_dom.css.ss.5.tsv
    Untracked:  data/2_0.3_node_dom.css.ss.5.tsv
    Untracked:  data/3_0.3_edge_wil.css.ss.5.tsv
    Untracked:  data/3_0.3_node_wil.css.ss.5.tsv
    Untracked:  data/4_0.3_edge_phy.css.ss.5.tsv
    Untracked:  data/5_0.3_edge_dom.phy.ss.5.tsv
    Untracked:  data/6_0.3_edge_wil.phy.ss.5.tsv
    Untracked:  data/7_0.3_edge_fun.css.ss.5.tsv
    Untracked:  data/8_0.3_edge_dom.fun.ss.5.tsv
    Untracked:  data/9_0.3_edge_wil.fun.ss.5.tsv
    Untracked:  data/Chesapeake_bay_links.csv
    Untracked:  data/Chesapeake_bay_nodes.csv
    Untracked:  data/Dunne2013PBioSupData.xlsx
    Untracked:  data/M_PA_003.csv
    Untracked:  data/NEE2017_nodes.csv
    Untracked:  data/Otago_Data_Links.csv
    Untracked:  data/Otago_Data_Nodes.csv
    Untracked:  data/Pilosof_2017NEE_interlayer_hosts.csv
    Untracked:  data/Pilosof_2017NEE_interlayer_parasites.csv
    Untracked:  data/Pilosof_etal_NEE2017_1.csv
    Untracked:  data/Pilosof_etal_NEE2017_2.csv
    Untracked:  data/Pilosof_etal_NEE2017_3.csv
    Untracked:  data/Pilosof_etal_NEE2017_4.csv
    Untracked:  data/Pilosof_etal_NEE2017_5.csv
    Untracked:  data/Pilosof_etal_NEE2017_6.csv
    Untracked:  data/Tur2016.csv
    Untracked:  data/Ural_valley_A_HP_048.csv
    Untracked:  data/chilean_NTIneg.txt
    Untracked:  data/chilean_NTIpos.txt
    Untracked:  data/chilean_TI.txt
    Untracked:  data/chilean_metadata.xls
    Untracked:  data/kongsfjorden_links.RData
    Untracked:  data/kongsfjorden_nodes.RData
    Untracked:  data/siberia1982_7_links.RData
    Untracked:  data/siberia1982_7_nodes.RData
    Untracked:  data/vizentin-bugoni_et_al_2016_complementary.xlsx
    Untracked:  infomap-script.py
    Untracked:  infomap.exe

Unstaged changes:
    Deleted:    analysis/Infomap_HW.Rmd
    Modified:   analysis/Networks_HW3.Rmd

</code></pre>
<p>
Note that any generated files, e.g. HTML, png, CSS, etc., are not included in this status report because it is ok for generated content to have uncommitted changes.
</p>
</div>
</div>
</div>
</div>
<hr>
</div>
<div id="versions" class="tab-pane fade">

<p>
These are the previous versions of the repository in which changes were made to the R Markdown (<code>analysis/Networks_HW6.Rmd</code>) and HTML (<code>docs/Networks_HW6.html</code>) files. If you’ve configured a remote Git repository (see <code>?wflow_git_remote</code>), click on the hyperlinks in the table below to view the files as they were in that past version.
</p>
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
File
</th>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
<th>
Message
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/KiseokUchicago/Networks_HW_S2021/blob/e19e22c125aa8dfc33b4bddefafb4e338463b2d3/analysis/Networks_HW6.Rmd" target="_blank">e19e22c</a>
</td>
<td>
KiseokUchicago
</td>
<td>
2021-05-20
</td>
<td>
start
</td>
</tr>
</tbody>
</table>
</div>
<hr>
</div>
</div>
</div>
<div id="homework6-models-of-networks" class="section level2">
<h2>Homework6 (Models of networks)</h2>
</div>
<div id="coding-assignment-for-ecev-44500-networks-in-ecology-and-evolution" class="section level2">
<h2>Coding assignment for ECEV 44500 Networks in Ecology and Evolution</h2>
<p>Professor: <strong>Mercedes Pascual</strong>, <strong>Sergio A. Alcala Corona</strong><br />
Student: <strong>Kiseok Lee</strong></p>
<pre class="r"><code># libraries
library(igraph)
library(bipartite)
library(dplyr)
library(ggplot2)
library(RColorBrewer)
library(vegan)
library(tidyverse)
library(magrittr)
library(readxl)
library(reshape2)
library(gtools)
library(devtools)</code></pre>
<pre class="r"><code># install_github(&#39;quicklizard99/Basingstoke&#39;)
library(Basingstoke)</code></pre>
</div>
<div id="define-function" class="section level1">
<h1>define function</h1>
<pre class="r"><code># We will need this function later. It is based on the code from lab 1.
plot_web_trophic &lt;- function(g){
  basal &lt;- which(igraph::degree(g, mode = &#39;in&#39;) == 0) # Basal species do not have ingoing links
  top &lt;- which(igraph::degree(g, mode = &#39;out&#39;) == 0) # Top species do not have outgoing links
  interm &lt;- V(g)[which(!V(g) %in% c(basal,top))] # Intermediate are all the rest
  
  V(g)$troph_pos &lt;- rep(0,length(V(g)))
  V(g)$troph_pos[which(V(g)$name %in% basal)] &lt;- 1
  V(g)$troph_pos[which(V(g)$name %in% top)] &lt;- 3
  V(g)$troph_pos[which(V(g)$name %in% interm)] &lt;- 2
  # create a matrix forthe layout coordinates.
  coords &lt;- matrix(nrow=length(V(g)), ncol=2) #
  # The x positions are randomly selected
  coords[,1] &lt;- runif(length(V(g)))
  # The y positions are the trophoc positions
  coords[,2] &lt;- V(g)$troph_pos
  par(mar=c(0,0,0,0))
  plot(g,layout=coords,
              vertex.color=V(g)$troph_pos,
              vertex.label=NA,
              vertex.size=8,
              edge.color=&#39;black&#39;,
              edge.arrow.size=.3,
              edge.width=.5)
}</code></pre>
<div id="network-generation" class="section level2">
<h2>1. Network generation</h2>
<p>Generating synthetic networks is the process of filling an adjaceny matrix according to a given set of rules. We will examine 3 models applied to food webs that create unweighted food webs.</p>
<p>A technical note: if you are into studying food webs, then exploring the packages cheddar and Basingstoke may prove very useful!</p>
</div>
<div id="random-model" class="section level2">
<h2>1.1 Random model</h2>
<p>The most straightforward way to generate a network is the random model in which interactions are filled randomly to obtain a network with a given connectance. “Any link among S species occurs with the same probability (P) equal to C” [1]. First let’s do that with Basingstoke just to see how this package works.</p>
<pre class="r"><code># Create 1 web with S species and a density of C
S &lt;- 20 # Number of species
C &lt;- 0.1 # Connectance (density)
web &lt;- RandomLinks(1,S,C)
# Results is a list of &quot;edge list&quot; objects.
web &lt;- web[[1]]
# Plot the web
g &lt;- igraph::graph.data.frame(web)
graph.density(g)</code></pre>
<pre><code>[1] 0.1052632</code></pre>
<pre class="r"><code>plot(g)</code></pre>
<p><img src="figure/Networks_HW6.Rmd/unnamed-chunk-4-1.png" width="1056" style="display: block; margin: auto;" /></p>
<p>Creating adjacency matrix</p>
<pre class="r"><code># Now transform the edge-list to an adjacency matrix.
A &lt;- igraph::get.adjacency(g, sparse = F)
A[mixedsort(rownames(A)),mixedsort(colnames(A))][1:5,1:5] # mixedsort comes from library gtools. It sorts strings with embedded numbers so that the numbers are in the correct order</code></pre>
<pre><code>  1 2 3 4 5
1 1 0 0 1 0
2 0 0 0 0 0
3 0 0 0 0 0
4 0 0 0 0 1
5 0 0 0 0 1</code></pre>
<p>Now let’s try to program that one ourselves. We can use a command that randomly generates 0’s or 1’s with a given probability (following the definition “…the same probability (P) equal to C…” )</p>
<pre class="r"><code>web &lt;- matrix(data = rbinom(S*S,1,C),nrow = S, ncol = S) # rbinom here generates either 0 or 1 with a probability of success for 1 equals C.
g &lt;- igraph::graph.adjacency(web)
graph.density(g)</code></pre>
<pre><code>[1] 0.1052632</code></pre>
<pre class="r"><code># We can take advantage of the basingstoke package to generate multiple webs and for plotting nicely.
webs &lt;- CommunityFactory(S=S, n=1, generator=RandomLinks, C=C) # use this function to generate an object of class &quot;community&quot;
class(webs) # This is a list</code></pre>
<pre><code>[1] &quot;CommunityCollection&quot; &quot;list&quot;               </code></pre>
<pre class="r"><code># The community class has these features
names(webs$`Artificial community 1`)</code></pre>
<pre><code>[1] &quot;nodes&quot;         &quot;properties&quot;    &quot;trophic.links&quot;</code></pre>
<pre class="r"><code># Now plot the matrix
PlotPredationMatrix(webs[[1]])</code></pre>
<p><img src="figure/Networks_HW6.Rmd/unnamed-chunk-6-1.png" width="1056" style="display: block; margin: auto;" /></p>
</div>
<div id="problem-1.-what-essential-features-of-food-webs-does-the-random-algorithm-miss" class="section level2">
<h2>Problem 1. What essential features of food webs does the random algorithm miss?</h2>
<p>Because it is binary, it is missing the interaction coefficients(strengths) between predator and prey.</p>
</div>
<div id="cascade-model" class="section level2">
<h2>1.2 Cascade model</h2>
<p>In the cascade model, each species is assigned “a random value drawn uniformly from the interval [0,1] and each species has probability P=2CS/(S−1)=2LS/(S−1) of consuming only species with values less than its own.” [1] Let’s try that algorithm while learning a bit more on the packages.</p>
<pre class="r"><code>web &lt;- CascadeModelLinks(1,S,C)
# Results is a list of &quot;edge list&quot; objects.
web &lt;- web[[1]]
# Plot the web
g &lt;- igraph::graph.data.frame(web)
graph.density(g)</code></pre>
<pre><code>[1] 0.1078947</code></pre>
<pre class="r"><code>plot(g)</code></pre>
<p><img src="figure/Networks_HW6.Rmd/unnamed-chunk-7-1.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Now transform the edge-list to an adjacency matrix.
A &lt;- igraph::get.adjacency(g, sparse = F)
#A[mixedsort(rownames(A)),mixedsort(colnames(A))] # mixedsort comes from library gtools</code></pre>
</div>
<div id="problem-2.-try-to-implement-the-cascade-model-by-yourself." class="section level2">
<h2>Problem 2. Try to implement the cascade model by yourself.</h2>
<p>each species is assigned a random value drawn uniformly from the interval [0,1] and each species has probability P=2CS/(S−1)=2LS/(S−1) of consuming only species with values less than its own.</p>
<pre class="r"><code># create random value for each species 
species_uni &lt;- runif(S)
P = (2*C*S) / (S-1)

# Matrix
A_cas &lt;- matrix(rep(0,S*S),nrow = S, ncol = S)

# loop through row i and col j 
for (i in 1:length(species_uni)){
  for (j in 1:length(species_uni)){
    print(i)
    print(j)
    if (species_uni[i] &gt; species_uni[j]){
      A_cas[i,j] &lt;- rbinom(1,1,P)
    }
  }
}</code></pre>
<pre><code>[1] 1
[1] 1
[1] 1
[1] 2
[1] 1
[1] 3
[1] 1
[1] 4
[1] 1
[1] 5
[1] 1
[1] 6
[1] 1
[1] 7
[1] 1
[1] 8
[1] 1
[1] 9
[1] 1
[1] 10
[1] 1
[1] 11
[1] 1
[1] 12
[1] 1
[1] 13
[1] 1
[1] 14
[1] 1
[1] 15
[1] 1
[1] 16
[1] 1
[1] 17
[1] 1
[1] 18
[1] 1
[1] 19
[1] 1
[1] 20
[1] 2
[1] 1
[1] 2
[1] 2
[1] 2
[1] 3
[1] 2
[1] 4
[1] 2
[1] 5
[1] 2
[1] 6
[1] 2
[1] 7
[1] 2
[1] 8
[1] 2
[1] 9
[1] 2
[1] 10
[1] 2
[1] 11
[1] 2
[1] 12
[1] 2
[1] 13
[1] 2
[1] 14
[1] 2
[1] 15
[1] 2
[1] 16
[1] 2
[1] 17
[1] 2
[1] 18
[1] 2
[1] 19
[1] 2
[1] 20
[1] 3
[1] 1
[1] 3
[1] 2
[1] 3
[1] 3
[1] 3
[1] 4
[1] 3
[1] 5
[1] 3
[1] 6
[1] 3
[1] 7
[1] 3
[1] 8
[1] 3
[1] 9
[1] 3
[1] 10
[1] 3
[1] 11
[1] 3
[1] 12
[1] 3
[1] 13
[1] 3
[1] 14
[1] 3
[1] 15
[1] 3
[1] 16
[1] 3
[1] 17
[1] 3
[1] 18
[1] 3
[1] 19
[1] 3
[1] 20
[1] 4
[1] 1
[1] 4
[1] 2
[1] 4
[1] 3
[1] 4
[1] 4
[1] 4
[1] 5
[1] 4
[1] 6
[1] 4
[1] 7
[1] 4
[1] 8
[1] 4
[1] 9
[1] 4
[1] 10
[1] 4
[1] 11
[1] 4
[1] 12
[1] 4
[1] 13
[1] 4
[1] 14
[1] 4
[1] 15
[1] 4
[1] 16
[1] 4
[1] 17
[1] 4
[1] 18
[1] 4
[1] 19
[1] 4
[1] 20
[1] 5
[1] 1
[1] 5
[1] 2
[1] 5
[1] 3
[1] 5
[1] 4
[1] 5
[1] 5
[1] 5
[1] 6
[1] 5
[1] 7
[1] 5
[1] 8
[1] 5
[1] 9
[1] 5
[1] 10
[1] 5
[1] 11
[1] 5
[1] 12
[1] 5
[1] 13
[1] 5
[1] 14
[1] 5
[1] 15
[1] 5
[1] 16
[1] 5
[1] 17
[1] 5
[1] 18
[1] 5
[1] 19
[1] 5
[1] 20
[1] 6
[1] 1
[1] 6
[1] 2
[1] 6
[1] 3
[1] 6
[1] 4
[1] 6
[1] 5
[1] 6
[1] 6
[1] 6
[1] 7
[1] 6
[1] 8
[1] 6
[1] 9
[1] 6
[1] 10
[1] 6
[1] 11
[1] 6
[1] 12
[1] 6
[1] 13
[1] 6
[1] 14
[1] 6
[1] 15
[1] 6
[1] 16
[1] 6
[1] 17
[1] 6
[1] 18
[1] 6
[1] 19
[1] 6
[1] 20
[1] 7
[1] 1
[1] 7
[1] 2
[1] 7
[1] 3
[1] 7
[1] 4
[1] 7
[1] 5
[1] 7
[1] 6
[1] 7
[1] 7
[1] 7
[1] 8
[1] 7
[1] 9
[1] 7
[1] 10
[1] 7
[1] 11
[1] 7
[1] 12
[1] 7
[1] 13
[1] 7
[1] 14
[1] 7
[1] 15
[1] 7
[1] 16
[1] 7
[1] 17
[1] 7
[1] 18
[1] 7
[1] 19
[1] 7
[1] 20
[1] 8
[1] 1
[1] 8
[1] 2
[1] 8
[1] 3
[1] 8
[1] 4
[1] 8
[1] 5
[1] 8
[1] 6
[1] 8
[1] 7
[1] 8
[1] 8
[1] 8
[1] 9
[1] 8
[1] 10
[1] 8
[1] 11
[1] 8
[1] 12
[1] 8
[1] 13
[1] 8
[1] 14
[1] 8
[1] 15
[1] 8
[1] 16
[1] 8
[1] 17
[1] 8
[1] 18
[1] 8
[1] 19
[1] 8
[1] 20
[1] 9
[1] 1
[1] 9
[1] 2
[1] 9
[1] 3
[1] 9
[1] 4
[1] 9
[1] 5
[1] 9
[1] 6
[1] 9
[1] 7
[1] 9
[1] 8
[1] 9
[1] 9
[1] 9
[1] 10
[1] 9
[1] 11
[1] 9
[1] 12
[1] 9
[1] 13
[1] 9
[1] 14
[1] 9
[1] 15
[1] 9
[1] 16
[1] 9
[1] 17
[1] 9
[1] 18
[1] 9
[1] 19
[1] 9
[1] 20
[1] 10
[1] 1
[1] 10
[1] 2
[1] 10
[1] 3
[1] 10
[1] 4
[1] 10
[1] 5
[1] 10
[1] 6
[1] 10
[1] 7
[1] 10
[1] 8
[1] 10
[1] 9
[1] 10
[1] 10
[1] 10
[1] 11
[1] 10
[1] 12
[1] 10
[1] 13
[1] 10
[1] 14
[1] 10
[1] 15
[1] 10
[1] 16
[1] 10
[1] 17
[1] 10
[1] 18
[1] 10
[1] 19
[1] 10
[1] 20
[1] 11
[1] 1
[1] 11
[1] 2
[1] 11
[1] 3
[1] 11
[1] 4
[1] 11
[1] 5
[1] 11
[1] 6
[1] 11
[1] 7
[1] 11
[1] 8
[1] 11
[1] 9
[1] 11
[1] 10
[1] 11
[1] 11
[1] 11
[1] 12
[1] 11
[1] 13
[1] 11
[1] 14
[1] 11
[1] 15
[1] 11
[1] 16
[1] 11
[1] 17
[1] 11
[1] 18
[1] 11
[1] 19
[1] 11
[1] 20
[1] 12
[1] 1
[1] 12
[1] 2
[1] 12
[1] 3
[1] 12
[1] 4
[1] 12
[1] 5
[1] 12
[1] 6
[1] 12
[1] 7
[1] 12
[1] 8
[1] 12
[1] 9
[1] 12
[1] 10
[1] 12
[1] 11
[1] 12
[1] 12
[1] 12
[1] 13
[1] 12
[1] 14
[1] 12
[1] 15
[1] 12
[1] 16
[1] 12
[1] 17
[1] 12
[1] 18
[1] 12
[1] 19
[1] 12
[1] 20
[1] 13
[1] 1
[1] 13
[1] 2
[1] 13
[1] 3
[1] 13
[1] 4
[1] 13
[1] 5
[1] 13
[1] 6
[1] 13
[1] 7
[1] 13
[1] 8
[1] 13
[1] 9
[1] 13
[1] 10
[1] 13
[1] 11
[1] 13
[1] 12
[1] 13
[1] 13
[1] 13
[1] 14
[1] 13
[1] 15
[1] 13
[1] 16
[1] 13
[1] 17
[1] 13
[1] 18
[1] 13
[1] 19
[1] 13
[1] 20
[1] 14
[1] 1
[1] 14
[1] 2
[1] 14
[1] 3
[1] 14
[1] 4
[1] 14
[1] 5
[1] 14
[1] 6
[1] 14
[1] 7
[1] 14
[1] 8
[1] 14
[1] 9
[1] 14
[1] 10
[1] 14
[1] 11
[1] 14
[1] 12
[1] 14
[1] 13
[1] 14
[1] 14
[1] 14
[1] 15
[1] 14
[1] 16
[1] 14
[1] 17
[1] 14
[1] 18
[1] 14
[1] 19
[1] 14
[1] 20
[1] 15
[1] 1
[1] 15
[1] 2
[1] 15
[1] 3
[1] 15
[1] 4
[1] 15
[1] 5
[1] 15
[1] 6
[1] 15
[1] 7
[1] 15
[1] 8
[1] 15
[1] 9
[1] 15
[1] 10
[1] 15
[1] 11
[1] 15
[1] 12
[1] 15
[1] 13
[1] 15
[1] 14
[1] 15
[1] 15
[1] 15
[1] 16
[1] 15
[1] 17
[1] 15
[1] 18
[1] 15
[1] 19
[1] 15
[1] 20
[1] 16
[1] 1
[1] 16
[1] 2
[1] 16
[1] 3
[1] 16
[1] 4
[1] 16
[1] 5
[1] 16
[1] 6
[1] 16
[1] 7
[1] 16
[1] 8
[1] 16
[1] 9
[1] 16
[1] 10
[1] 16
[1] 11
[1] 16
[1] 12
[1] 16
[1] 13
[1] 16
[1] 14
[1] 16
[1] 15
[1] 16
[1] 16
[1] 16
[1] 17
[1] 16
[1] 18
[1] 16
[1] 19
[1] 16
[1] 20
[1] 17
[1] 1
[1] 17
[1] 2
[1] 17
[1] 3
[1] 17
[1] 4
[1] 17
[1] 5
[1] 17
[1] 6
[1] 17
[1] 7
[1] 17
[1] 8
[1] 17
[1] 9
[1] 17
[1] 10
[1] 17
[1] 11
[1] 17
[1] 12
[1] 17
[1] 13
[1] 17
[1] 14
[1] 17
[1] 15
[1] 17
[1] 16
[1] 17
[1] 17
[1] 17
[1] 18
[1] 17
[1] 19
[1] 17
[1] 20
[1] 18
[1] 1
[1] 18
[1] 2
[1] 18
[1] 3
[1] 18
[1] 4
[1] 18
[1] 5
[1] 18
[1] 6
[1] 18
[1] 7
[1] 18
[1] 8
[1] 18
[1] 9
[1] 18
[1] 10
[1] 18
[1] 11
[1] 18
[1] 12
[1] 18
[1] 13
[1] 18
[1] 14
[1] 18
[1] 15
[1] 18
[1] 16
[1] 18
[1] 17
[1] 18
[1] 18
[1] 18
[1] 19
[1] 18
[1] 20
[1] 19
[1] 1
[1] 19
[1] 2
[1] 19
[1] 3
[1] 19
[1] 4
[1] 19
[1] 5
[1] 19
[1] 6
[1] 19
[1] 7
[1] 19
[1] 8
[1] 19
[1] 9
[1] 19
[1] 10
[1] 19
[1] 11
[1] 19
[1] 12
[1] 19
[1] 13
[1] 19
[1] 14
[1] 19
[1] 15
[1] 19
[1] 16
[1] 19
[1] 17
[1] 19
[1] 18
[1] 19
[1] 19
[1] 19
[1] 20
[1] 20
[1] 1
[1] 20
[1] 2
[1] 20
[1] 3
[1] 20
[1] 4
[1] 20
[1] 5
[1] 20
[1] 6
[1] 20
[1] 7
[1] 20
[1] 8
[1] 20
[1] 9
[1] 20
[1] 10
[1] 20
[1] 11
[1] 20
[1] 12
[1] 20
[1] 13
[1] 20
[1] 14
[1] 20
[1] 15
[1] 20
[1] 16
[1] 20
[1] 17
[1] 20
[1] 18
[1] 20
[1] 19
[1] 20
[1] 20</code></pre>
<pre class="r"><code>diag(A_cas) # no intra consumption</code></pre>
<pre><code> [1] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</code></pre>
<pre class="r"><code>A_cas</code></pre>
<pre><code>      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13]
 [1,]    0    0    1    0    1    0    1    0    0     0     0     0     0
 [2,]    0    0    0    0    1    0    0    0    0     0     0     0     0
 [3,]    0    0    0    0    0    0    0    0    0     0     0     0     0
 [4,]    0    0    0    0    0    1    0    0    0     0     0     0     0
 [5,]    0    0    0    0    0    0    0    0    0     0     0     0     0
 [6,]    0    0    0    0    0    0    0    0    0     0     0     0     0
 [7,]    0    0    0    0    0    0    0    0    0     0     0     0     0
 [8,]    0    0    0    0    0    1    0    0    0     0     0     0     0
 [9,]    0    0    0    0    1    1    0    0    0     0     0     0     0
[10,]    0    0    1    0    1    0    0    0    0     0     0     0     0
[11,]    0    0    0    0    0    0    0    0    0     0     0     0     0
[12,]    0    0    1    0    0    0    0    0    0     0     0     0     0
[13,]    0    1    0    0    0    0    0    0    1     1     0     0     0
[14,]    0    0    0    0    0    0    0    0    0     0     0     0     0
[15,]    0    0    0    0    0    0    0    0    0     0     0     0     0
[16,]    0    0    0    0    0    0    0    0    0     0     0     0     0
[17,]    0    0    0    0    0    0    0    0    0     0     0     0     0
[18,]    0    0    1    0    1    0    0    0    0     0     0     0     0
[19,]    0    0    0    0    0    0    0    0    0     0     0     0     0
[20,]    0    0    0    1    0    0    0    0    0     1     0     0     0
      [,14] [,15] [,16] [,17] [,18] [,19] [,20]
 [1,]     0     1     0     1     1     0     0
 [2,]     0     0     0     0     0     0     0
 [3,]     0     0     0     1     0     0     0
 [4,]     1     0     0     1     0     1     0
 [5,]     0     0     0     0     0     0     0
 [6,]     0     0     0     0     0     0     0
 [7,]     0     0     1     0     0     0     0
 [8,]     0     1     1     0     0     0     0
 [9,]     0     0     0     1     0     1     0
[10,]     1     1     1     0     0     0     0
[11,]     0     1     1     0     0     1     0
[12,]     0     0     0     0     0     0     0
[13,]     0     0     1     0     0     0     0
[14,]     0     0     0     0     0     1     0
[15,]     0     0     0     0     0     0     0
[16,]     0     0     0     0     0     1     0
[17,]     0     0     0     0     0     0     0
[18,]     0     0     1     0     0     0     0
[19,]     0     0     0     0     0     0     0
[20,]     1     0     0     0     1     0     0</code></pre>
<pre class="r"><code>g_cas &lt;- igraph::graph.adjacency(A_cas, mode = &#39;directed&#39;)
graph.density(g_cas)</code></pre>
<pre><code>[1] 0.1105263</code></pre>
<pre class="r"><code>plot(g_cas)</code></pre>
<p><img src="figure/Networks_HW6.Rmd/unnamed-chunk-8-1.png" width="1056" style="display: block; margin: auto;" /></p>
<p>Let’s now use the basingstoke package for plotting also.</p>
<pre class="r"><code>webs &lt;- CommunityFactory(S=S, n=1, generator=CascadeModelLinks, C=C) # use this function to generate an object of class &quot;community&quot;
class(webs) # This is a list</code></pre>
<pre><code>[1] &quot;CommunityCollection&quot; &quot;list&quot;               </code></pre>
<pre class="r"><code># The community class has these features
names(webs$`Artificial community 1`)</code></pre>
<pre><code>[1] &quot;nodes&quot;         &quot;properties&quot;    &quot;trophic.links&quot;</code></pre>
<pre class="r"><code># Now plot the matrix
PlotPredationMatrix(webs[[1]])</code></pre>
<p><img src="figure/Networks_HW6.Rmd/unnamed-chunk-9-1.png" width="1056" style="display: block; margin: auto;" /></p>
<p>In fact the CommunityFactory function is very very convenient. It can generate multiple communities, with additional constraints. For example:</p>
<pre class="r"><code># Generate 4 communities with 3 basal species. This condition goes into the &quot;accept&quot; argument of the function.
webs &lt;- CommunityFactory(S=S, n=4, C=C, generator=CascadeModelLinks,
                         accept=function(z) sum(IsBasalNode(z))==3)
# All have 3 basal species
sapply(webs, function(z) length(BasalNodes(z)))</code></pre>
<pre><code>Artificial community 1 Artificial community 2 Artificial community 3 
                     3                      3                      3 
Artificial community 4 
                     3 </code></pre>
<pre class="r"><code>par(mfrow=c(2,2))
for (i in 1:4){PlotPredationMatrix(webs[[i]])}</code></pre>
<p><img src="figure/Networks_HW6.Rmd/unnamed-chunk-10-1.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code>dev.off()</code></pre>
<pre><code>null device 
          1 </code></pre>
<p>Sometimes it is more convenient to work with igraph. Here is a general way to move from a community object in basingstoke to igraph. From igraph it is easy to obtain an adjacency matrix as we have seen in our previous labs when moving between data structures.</p>
<pre class="r"><code># webs is the Basingstoke object
g &lt;- graph.data.frame(webs[[1]]$trophic.links, vertices = webs[[1]]$nodes)
plot(g)</code></pre>
<p><img src="figure/Networks_HW6.Rmd/unnamed-chunk-11-1.png" width="1056" style="display: block; margin: auto;" /></p>
</div>
<div id="niche-model" class="section level2">
<h2>1.3 Niche model</h2>
<p>In the Niche Model, proposed in [1], species are ordered according to a randomly drawn ‘niche value’, ni. A consumer eats all species falling into a range whose center ci&lt;ni is chosen at random from a beta distribution. Thus, diet is restricted to being contiguous, reflecting the assumption that diets can be arranged along one niche dimension. Notice how there are no gaps in diet in the prey species of each consumer. We can use the same syntax we have seen previously for CascadeModelLinks and CommunityFactory.</p>
<pre class="r"><code>web &lt;- NicheModelLinks(1,S,C)[[1]]
PlotPredationMatrix(webs[[1]])</code></pre>
<p><img src="figure/Networks_HW6.Rmd/unnamed-chunk-12-1.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Can also plot with igraph
web &lt;- as.data.frame(web)
web &lt;- with(web, web[order(resource,consumer),])
nodes &lt;- data.frame(name=1:S)
g &lt;- graph.data.frame(web, vertices = nodes)
plot_web_trophic(g)</code></pre>
<p><img src="figure/Networks_HW6.Rmd/unnamed-chunk-12-2.png" width="1056" style="display: block; margin: auto;" /> If you wanted to write your own code for the niche model here are somee Guidelines: Follow the caption in Fig. 1 of Williams and Martinez (2000), and take the beta value for the beta distribution to be (S-1)/2SC-1 (as in equation 10 in the Supp Info of Allesina et al. (Science, 2008)). You can also get some inspiration from the function NicheModelLinks for the last step determining the consumers.</p>
</div>
<div id="the-group-model" class="section level2">
<h2>1.4 The group model</h2>
<p>In the group model, species are assigned to groups, each with its own per-group probability of a link. In addition, there are probabilities to connect between groups. The following code is adapted from Stefano Allesina.</p>
<pre class="r"><code>generate_group_model &lt;- function(groups, P, S){
  ## Pij is the probability of connecting a member of group i with a member of group j
  ## S is the total number of species
  ## groups is a vector of group memberships  
  
  # This draws S^2 edges (0 or 1) at random, with a probability from the probability matrix P[groups, groups].
  # See comment below on P[groups, groups]
  M &lt;- matrix(rbinom(S^2, size = 1, prob = P[groups, groups]), S, S)
  ## sort elements in M by groups
  M &lt;- M[order(groups), order(groups)]
  return(M)
}

S &lt;- 10
groups &lt;- rbinom(S, size = 2, 0.5)
groups &lt;- groups + 1
m &lt;- max(groups)
P &lt;- matrix(runif((m)^2), m, m)

# In the function generate_group_model, the code P[groups,groups] asssigns
# probabilities from matrix P to pairs of species that belong to groups i,j. You
# can see the pairings with the following line. 

outer(groups,groups,FUN = &#39;paste&#39;)</code></pre>
<pre><code>      [,1]  [,2]  [,3]  [,4]  [,5]  [,6]  [,7]  [,8]  [,9]  [,10]
 [1,] &quot;3 3&quot; &quot;3 2&quot; &quot;3 1&quot; &quot;3 2&quot; &quot;3 2&quot; &quot;3 1&quot; &quot;3 1&quot; &quot;3 2&quot; &quot;3 2&quot; &quot;3 1&quot;
 [2,] &quot;2 3&quot; &quot;2 2&quot; &quot;2 1&quot; &quot;2 2&quot; &quot;2 2&quot; &quot;2 1&quot; &quot;2 1&quot; &quot;2 2&quot; &quot;2 2&quot; &quot;2 1&quot;
 [3,] &quot;1 3&quot; &quot;1 2&quot; &quot;1 1&quot; &quot;1 2&quot; &quot;1 2&quot; &quot;1 1&quot; &quot;1 1&quot; &quot;1 2&quot; &quot;1 2&quot; &quot;1 1&quot;
 [4,] &quot;2 3&quot; &quot;2 2&quot; &quot;2 1&quot; &quot;2 2&quot; &quot;2 2&quot; &quot;2 1&quot; &quot;2 1&quot; &quot;2 2&quot; &quot;2 2&quot; &quot;2 1&quot;
 [5,] &quot;2 3&quot; &quot;2 2&quot; &quot;2 1&quot; &quot;2 2&quot; &quot;2 2&quot; &quot;2 1&quot; &quot;2 1&quot; &quot;2 2&quot; &quot;2 2&quot; &quot;2 1&quot;
 [6,] &quot;1 3&quot; &quot;1 2&quot; &quot;1 1&quot; &quot;1 2&quot; &quot;1 2&quot; &quot;1 1&quot; &quot;1 1&quot; &quot;1 2&quot; &quot;1 2&quot; &quot;1 1&quot;
 [7,] &quot;1 3&quot; &quot;1 2&quot; &quot;1 1&quot; &quot;1 2&quot; &quot;1 2&quot; &quot;1 1&quot; &quot;1 1&quot; &quot;1 2&quot; &quot;1 2&quot; &quot;1 1&quot;
 [8,] &quot;2 3&quot; &quot;2 2&quot; &quot;2 1&quot; &quot;2 2&quot; &quot;2 2&quot; &quot;2 1&quot; &quot;2 1&quot; &quot;2 2&quot; &quot;2 2&quot; &quot;2 1&quot;
 [9,] &quot;2 3&quot; &quot;2 2&quot; &quot;2 1&quot; &quot;2 2&quot; &quot;2 2&quot; &quot;2 1&quot; &quot;2 1&quot; &quot;2 2&quot; &quot;2 2&quot; &quot;2 1&quot;
[10,] &quot;1 3&quot; &quot;1 2&quot; &quot;1 1&quot; &quot;1 2&quot; &quot;1 2&quot; &quot;1 1&quot; &quot;1 1&quot; &quot;1 2&quot; &quot;1 2&quot; &quot;1 1&quot;</code></pre>
<pre class="r"><code>M &lt;- generate_group_model(groups, P, S)

groups &lt;- groups[order(groups)]  # Now this is needed, for the plotting,
## Make a plot by groups
Mplot &lt;- tibble::as_tibble(melt(t(M))) %&gt;% 
  mutate(Var2 = S - Var2 + 1, # Change this because the origin of a y axis of a plot start at the bottom, but the origin of a y axis of the M matrix starts at the top.
         group1 = groups[Var1], # get the group for resources
         group2 = groups[Var2], # Get the groups for consumers
         tag = (group1-1) * (m) + group2) # Assign unique tag to later fill the square of within-groups and between-groups in the plot

Mplot %&gt;% ggplot(aes(x = Var1, y = Var2, fill = as.character(tag))) +
  geom_tile(alpha = 0.6) + theme_bw() +
  geom_point(size = 5, alpha = 0.5, aes(fill = as.factor(value), colour=  as.factor(value))) + 
  scale_colour_manual(values = c(&quot;white&quot;, &quot;black&quot;)) + theme(legend.position = &quot;none&quot;)</code></pre>
<p><img src="figure/Networks_HW6.Rmd/unnamed-chunk-13-1.png" width="1056" style="display: block; margin: auto;" /></p>
</div>
<div id="problem-3.-play-around-with-the-group-model.-create-a-matrix-with-more-than-3-groups-for-example-and-plot-it." class="section level2">
<h2>Problem 3. Play around with the group model. Create a matrix with more than 3 groups, for example, and plot it.</h2>
<ul>
<li>20 species</li>
<li>more than 3 groups</li>
</ul>
<pre class="r"><code>generate_group_model &lt;- function(groups, P, S){
  ## Pij is the probability of connecting a member of group i with a member of group j
  ## S is the total number of species
  ## groups is a vector of group memberships  
  
  # This draws S^2 edges (0 or 1) at random, with a probability from the probability matrix P[groups, groups].
  # See comment below on P[groups, groups]
  M &lt;- matrix(rbinom(S^2, size = 1, prob = P[groups, groups]), S, S)
  ## sort elements in M by groups
  M &lt;- M[order(groups), order(groups)]
  return(M)
}

# make the species 20
S &lt;- 20
# make it more than 4 groups
set.seed(1)
groups &lt;- rbinom(S, size = 4, 0.5)
groups &lt;- groups + 1
m &lt;- max(groups)
P &lt;- matrix(runif((m)^2), m, m)

# In the function generate_group_model, the code P[groups,groups] assigns
# probabilities from matrix P to pairs of species that belong to groups i,j. You
# can see the pairings with the following line. 

outer(groups,groups,FUN = &#39;paste&#39;)</code></pre>
<pre><code>      [,1]  [,2]  [,3]  [,4]  [,5]  [,6]  [,7]  [,8]  [,9]  [,10] [,11] [,12]
 [1,] &quot;2 2&quot; &quot;2 3&quot; &quot;2 3&quot; &quot;2 4&quot; &quot;2 2&quot; &quot;2 4&quot; &quot;2 5&quot; &quot;2 3&quot; &quot;2 3&quot; &quot;2 1&quot; &quot;2 2&quot; &quot;2 2&quot;
 [2,] &quot;3 2&quot; &quot;3 3&quot; &quot;3 3&quot; &quot;3 4&quot; &quot;3 2&quot; &quot;3 4&quot; &quot;3 5&quot; &quot;3 3&quot; &quot;3 3&quot; &quot;3 1&quot; &quot;3 2&quot; &quot;3 2&quot;
 [3,] &quot;3 2&quot; &quot;3 3&quot; &quot;3 3&quot; &quot;3 4&quot; &quot;3 2&quot; &quot;3 4&quot; &quot;3 5&quot; &quot;3 3&quot; &quot;3 3&quot; &quot;3 1&quot; &quot;3 2&quot; &quot;3 2&quot;
 [4,] &quot;4 2&quot; &quot;4 3&quot; &quot;4 3&quot; &quot;4 4&quot; &quot;4 2&quot; &quot;4 4&quot; &quot;4 5&quot; &quot;4 3&quot; &quot;4 3&quot; &quot;4 1&quot; &quot;4 2&quot; &quot;4 2&quot;
 [5,] &quot;2 2&quot; &quot;2 3&quot; &quot;2 3&quot; &quot;2 4&quot; &quot;2 2&quot; &quot;2 4&quot; &quot;2 5&quot; &quot;2 3&quot; &quot;2 3&quot; &quot;2 1&quot; &quot;2 2&quot; &quot;2 2&quot;
 [6,] &quot;4 2&quot; &quot;4 3&quot; &quot;4 3&quot; &quot;4 4&quot; &quot;4 2&quot; &quot;4 4&quot; &quot;4 5&quot; &quot;4 3&quot; &quot;4 3&quot; &quot;4 1&quot; &quot;4 2&quot; &quot;4 2&quot;
 [7,] &quot;5 2&quot; &quot;5 3&quot; &quot;5 3&quot; &quot;5 4&quot; &quot;5 2&quot; &quot;5 4&quot; &quot;5 5&quot; &quot;5 3&quot; &quot;5 3&quot; &quot;5 1&quot; &quot;5 2&quot; &quot;5 2&quot;
 [8,] &quot;3 2&quot; &quot;3 3&quot; &quot;3 3&quot; &quot;3 4&quot; &quot;3 2&quot; &quot;3 4&quot; &quot;3 5&quot; &quot;3 3&quot; &quot;3 3&quot; &quot;3 1&quot; &quot;3 2&quot; &quot;3 2&quot;
 [9,] &quot;3 2&quot; &quot;3 3&quot; &quot;3 3&quot; &quot;3 4&quot; &quot;3 2&quot; &quot;3 4&quot; &quot;3 5&quot; &quot;3 3&quot; &quot;3 3&quot; &quot;3 1&quot; &quot;3 2&quot; &quot;3 2&quot;
[10,] &quot;1 2&quot; &quot;1 3&quot; &quot;1 3&quot; &quot;1 4&quot; &quot;1 2&quot; &quot;1 4&quot; &quot;1 5&quot; &quot;1 3&quot; &quot;1 3&quot; &quot;1 1&quot; &quot;1 2&quot; &quot;1 2&quot;
[11,] &quot;2 2&quot; &quot;2 3&quot; &quot;2 3&quot; &quot;2 4&quot; &quot;2 2&quot; &quot;2 4&quot; &quot;2 5&quot; &quot;2 3&quot; &quot;2 3&quot; &quot;2 1&quot; &quot;2 2&quot; &quot;2 2&quot;
[12,] &quot;2 2&quot; &quot;2 3&quot; &quot;2 3&quot; &quot;2 4&quot; &quot;2 2&quot; &quot;2 4&quot; &quot;2 5&quot; &quot;2 3&quot; &quot;2 3&quot; &quot;2 1&quot; &quot;2 2&quot; &quot;2 2&quot;
[13,] &quot;3 2&quot; &quot;3 3&quot; &quot;3 3&quot; &quot;3 4&quot; &quot;3 2&quot; &quot;3 4&quot; &quot;3 5&quot; &quot;3 3&quot; &quot;3 3&quot; &quot;3 1&quot; &quot;3 2&quot; &quot;3 2&quot;
[14,] &quot;3 2&quot; &quot;3 3&quot; &quot;3 3&quot; &quot;3 4&quot; &quot;3 2&quot; &quot;3 4&quot; &quot;3 5&quot; &quot;3 3&quot; &quot;3 3&quot; &quot;3 1&quot; &quot;3 2&quot; &quot;3 2&quot;
[15,] &quot;4 2&quot; &quot;4 3&quot; &quot;4 3&quot; &quot;4 4&quot; &quot;4 2&quot; &quot;4 4&quot; &quot;4 5&quot; &quot;4 3&quot; &quot;4 3&quot; &quot;4 1&quot; &quot;4 2&quot; &quot;4 2&quot;
[16,] &quot;3 2&quot; &quot;3 3&quot; &quot;3 3&quot; &quot;3 4&quot; &quot;3 2&quot; &quot;3 4&quot; &quot;3 5&quot; &quot;3 3&quot; &quot;3 3&quot; &quot;3 1&quot; &quot;3 2&quot; &quot;3 2&quot;
[17,] &quot;4 2&quot; &quot;4 3&quot; &quot;4 3&quot; &quot;4 4&quot; &quot;4 2&quot; &quot;4 4&quot; &quot;4 5&quot; &quot;4 3&quot; &quot;4 3&quot; &quot;4 1&quot; &quot;4 2&quot; &quot;4 2&quot;
[18,] &quot;5 2&quot; &quot;5 3&quot; &quot;5 3&quot; &quot;5 4&quot; &quot;5 2&quot; &quot;5 4&quot; &quot;5 5&quot; &quot;5 3&quot; &quot;5 3&quot; &quot;5 1&quot; &quot;5 2&quot; &quot;5 2&quot;
[19,] &quot;3 2&quot; &quot;3 3&quot; &quot;3 3&quot; &quot;3 4&quot; &quot;3 2&quot; &quot;3 4&quot; &quot;3 5&quot; &quot;3 3&quot; &quot;3 3&quot; &quot;3 1&quot; &quot;3 2&quot; &quot;3 2&quot;
[20,] &quot;4 2&quot; &quot;4 3&quot; &quot;4 3&quot; &quot;4 4&quot; &quot;4 2&quot; &quot;4 4&quot; &quot;4 5&quot; &quot;4 3&quot; &quot;4 3&quot; &quot;4 1&quot; &quot;4 2&quot; &quot;4 2&quot;
      [,13] [,14] [,15] [,16] [,17] [,18] [,19] [,20]
 [1,] &quot;2 3&quot; &quot;2 3&quot; &quot;2 4&quot; &quot;2 3&quot; &quot;2 4&quot; &quot;2 5&quot; &quot;2 3&quot; &quot;2 4&quot;
 [2,] &quot;3 3&quot; &quot;3 3&quot; &quot;3 4&quot; &quot;3 3&quot; &quot;3 4&quot; &quot;3 5&quot; &quot;3 3&quot; &quot;3 4&quot;
 [3,] &quot;3 3&quot; &quot;3 3&quot; &quot;3 4&quot; &quot;3 3&quot; &quot;3 4&quot; &quot;3 5&quot; &quot;3 3&quot; &quot;3 4&quot;
 [4,] &quot;4 3&quot; &quot;4 3&quot; &quot;4 4&quot; &quot;4 3&quot; &quot;4 4&quot; &quot;4 5&quot; &quot;4 3&quot; &quot;4 4&quot;
 [5,] &quot;2 3&quot; &quot;2 3&quot; &quot;2 4&quot; &quot;2 3&quot; &quot;2 4&quot; &quot;2 5&quot; &quot;2 3&quot; &quot;2 4&quot;
 [6,] &quot;4 3&quot; &quot;4 3&quot; &quot;4 4&quot; &quot;4 3&quot; &quot;4 4&quot; &quot;4 5&quot; &quot;4 3&quot; &quot;4 4&quot;
 [7,] &quot;5 3&quot; &quot;5 3&quot; &quot;5 4&quot; &quot;5 3&quot; &quot;5 4&quot; &quot;5 5&quot; &quot;5 3&quot; &quot;5 4&quot;
 [8,] &quot;3 3&quot; &quot;3 3&quot; &quot;3 4&quot; &quot;3 3&quot; &quot;3 4&quot; &quot;3 5&quot; &quot;3 3&quot; &quot;3 4&quot;
 [9,] &quot;3 3&quot; &quot;3 3&quot; &quot;3 4&quot; &quot;3 3&quot; &quot;3 4&quot; &quot;3 5&quot; &quot;3 3&quot; &quot;3 4&quot;
[10,] &quot;1 3&quot; &quot;1 3&quot; &quot;1 4&quot; &quot;1 3&quot; &quot;1 4&quot; &quot;1 5&quot; &quot;1 3&quot; &quot;1 4&quot;
[11,] &quot;2 3&quot; &quot;2 3&quot; &quot;2 4&quot; &quot;2 3&quot; &quot;2 4&quot; &quot;2 5&quot; &quot;2 3&quot; &quot;2 4&quot;
[12,] &quot;2 3&quot; &quot;2 3&quot; &quot;2 4&quot; &quot;2 3&quot; &quot;2 4&quot; &quot;2 5&quot; &quot;2 3&quot; &quot;2 4&quot;
[13,] &quot;3 3&quot; &quot;3 3&quot; &quot;3 4&quot; &quot;3 3&quot; &quot;3 4&quot; &quot;3 5&quot; &quot;3 3&quot; &quot;3 4&quot;
[14,] &quot;3 3&quot; &quot;3 3&quot; &quot;3 4&quot; &quot;3 3&quot; &quot;3 4&quot; &quot;3 5&quot; &quot;3 3&quot; &quot;3 4&quot;
[15,] &quot;4 3&quot; &quot;4 3&quot; &quot;4 4&quot; &quot;4 3&quot; &quot;4 4&quot; &quot;4 5&quot; &quot;4 3&quot; &quot;4 4&quot;
[16,] &quot;3 3&quot; &quot;3 3&quot; &quot;3 4&quot; &quot;3 3&quot; &quot;3 4&quot; &quot;3 5&quot; &quot;3 3&quot; &quot;3 4&quot;
[17,] &quot;4 3&quot; &quot;4 3&quot; &quot;4 4&quot; &quot;4 3&quot; &quot;4 4&quot; &quot;4 5&quot; &quot;4 3&quot; &quot;4 4&quot;
[18,] &quot;5 3&quot; &quot;5 3&quot; &quot;5 4&quot; &quot;5 3&quot; &quot;5 4&quot; &quot;5 5&quot; &quot;5 3&quot; &quot;5 4&quot;
[19,] &quot;3 3&quot; &quot;3 3&quot; &quot;3 4&quot; &quot;3 3&quot; &quot;3 4&quot; &quot;3 5&quot; &quot;3 3&quot; &quot;3 4&quot;
[20,] &quot;4 3&quot; &quot;4 3&quot; &quot;4 4&quot; &quot;4 3&quot; &quot;4 4&quot; &quot;4 5&quot; &quot;4 3&quot; &quot;4 4&quot;</code></pre>
<pre class="r"><code>M &lt;- generate_group_model(groups, P, S)

groups &lt;- groups[order(groups)]  # Now this is needed, for the plotting,
## Make a plot by groups
Mplot &lt;- tibble::as_tibble(melt(t(M))) %&gt;% 
  mutate(Var2 = S - Var2 + 1, # Change this because the origin of a y axis of a plot start at the bottom, but the origin of a y axis of the M matrix starts at the top.
         group1 = groups[Var1], # get the group for resources
         group2 = groups[Var2], # Get the groups for consumers
         tag = (group1-1) * (m) + group2) # Assign unique tag to later fill the square of within-groups and between-groups in the plot

Mplot %&gt;% ggplot(aes(x = Var1, y = Var2, fill = as.character(tag))) +
  geom_tile(alpha = 0.6) + theme_bw() +
  geom_point(size = 5, alpha = 0.5, aes(fill = as.factor(value), colour=  as.factor(value))) + 
  scale_colour_manual(values = c(&quot;white&quot;, &quot;black&quot;)) + theme(legend.position = &quot;none&quot;)</code></pre>
<p><img src="figure/Networks_HW6.Rmd/unnamed-chunk-14-1.png" width="1056" style="display: block; margin: auto;" /></p>
<p>Then, modify the commands above to generate an anti-modular and a modular matrix, and plot those for comparison.</p>
<p>Let’s make an modular &amp; anti-modular matrix.</p>
<pre class="r"><code># make the species 10
S &lt;- 10
# make it more than 4 groups
set.seed(1)
groups &lt;- rbinom(S, size = 2, 0.5)
groups &lt;- groups + 1
m &lt;- max(groups)
P &lt;- matrix(runif((m)^2), m, m)

M &lt;- generate_group_model(groups, P, S)

groups &lt;- groups[order(groups)]  # Now this is needed, for the plotting,
## Make a plot by groups
Mplot &lt;- tibble::as_tibble(melt(t(M))) %&gt;% 
  mutate(Var2 = S - Var2 + 1, # Change this because the origin of a y axis of a plot start at the bottom, but the origin of a y axis of the M matrix starts at the top.
         group1 = groups[Var1], # get the group for resources
         group2 = groups[Var2], # Get the groups for consumers
         tag = (group1-1) * (m) + group2) # Assign unique tag to later fill the square of within-groups and between-groups in the plot

pl_m &lt;- Mplot %&gt;% ggplot(aes(x = Var1, y = Var2, fill = as.character(tag))) +
  geom_tile(alpha = 0.6) + theme_bw() +
  geom_point(size = 5, alpha = 0.5, aes(fill = as.factor(value), colour=  as.factor(value))) + 
  scale_colour_manual(values = c(&quot;white&quot;, &quot;black&quot;)) + theme(legend.position = &quot;none&quot;)
pl_m</code></pre>
<p><img src="figure/Networks_HW6.Rmd/unnamed-chunk-15-1.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Generate anti-modular group model
generate_nongroup_model &lt;- function(groups, P, S){
  # for anti-modular group model
  # we use 1-P
  M &lt;- matrix(rbinom(S^2, size = 1, prob = 1- (P[groups, groups])), S, S)
  ## sort elements in M by groups
  M &lt;- M[order(groups), order(groups)]
  return(M)
}

M_anti &lt;- generate_nongroup_model(groups, P, S)

groups &lt;- groups[order(groups)]  # Now this is needed, for the plotting,
## Make a plot by groups
Mplot_anti &lt;- tibble::as_tibble(melt(t(M_anti))) %&gt;% 
  mutate(Var2 = S - Var2 + 1, # Change this because the origin of a y axis of a plot start at the bottom, but the origin of a y axis of the M matrix starts at the top.
         group1 = groups[Var1], # get the group for resources
         group2 = groups[Var2], # Get the groups for consumers
         tag = (group1-1) * (m) + group2) # Assign unique tag to later fill the square of within-groups and between-groups in the plot

pl_m_anti &lt;- Mplot_anti %&gt;% ggplot(aes(x = Var1, y = Var2, fill = as.character(tag))) +
  geom_tile(alpha = 0.6) + theme_bw() +
  geom_point(size = 5, alpha = 0.5, aes(fill = as.factor(value), colour=  as.factor(value))) + 
  scale_colour_manual(values = c(&quot;white&quot;, &quot;black&quot;)) + theme(legend.position = &quot;none&quot;)
pl_m_anti</code></pre>
<p><img src="figure/Networks_HW6.Rmd/unnamed-chunk-15-2.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code>library(ggpubr)
ggarrange(pl_m, pl_m_anti,
          labels = c(&quot;Modular&quot;, &quot;Anti_modular&quot;),
          ncol = 2, nrow = 1)</code></pre>
<p><img src="figure/Networks_HW6.Rmd/unnamed-chunk-15-3.png" width="1056" style="display: block; margin: auto;" /> I couldn’t quite discern how the antimodular version is different from the modular one. The black dot distribution appears different.</p>
</div>
<div id="problem-4.-try-to-write-by-yourself-without-consulting-the-lecture-the-expression-for-the-likelihood-of-the-group-model." class="section level2">
<h2>Problem 4. Try to write by yourself (without consulting the lecture) the expression for the likelihood of the group model.</h2>
<p>I can’t formulate it without consulting the lecture</p>
</div>
<div id="comparing-networks" class="section level2">
<h2>2. Comparing networks</h2>
</div>
<div id="using-network-properties" class="section level2">
<h2>2.1 Using network properties</h2>
<p>Let’s put our ability to generate networks into practice. We will take an empirical food web, and try to capture some of its properties using generated food webs. Based on a set of network properties, we can then see which generative model captures best the empirical properties. Note that this is only an illustration!! We randomly selected some properties, but you could choose others. Up to you.</p>
<p>This function implements some properties.</p>
<pre class="r"><code>calculateProperties &lt;- function(g){
  A &lt;- as_adjacency_matrix(g, type = &#39;both&#39;, sparse = F)
  L &lt;- sum(A!=0)
  S &lt;- nrow(A)
  C &lt;- L/S^2
  #C &lt;- graph.density(g) # Also possible
  GenSD &lt;- sd(1/(L/S)*rowSums(A)) # Generality of species i
  VulSD &lt;- sd(1/(L/S)*colSums(A)) # Vulnerability of species i
  
  Top &lt;- sum(rowSums(A)==0)/vcount(g) # Top species do not have outgoing links
  Bas &lt;- sum(colSums(A)==0)/vcount(g) # Basal species do not have ingoing links
  Int &lt;- 1-(Top+Bas) # Intermediate are all the rest
  
  basal_species &lt;- which(colSums(A) == 0)
  chain_length_mean &lt;- mean(distances(g, v=basal_species))
  chain_length_sd &lt;- sd(distances(g, v=basal_species))
  Cannib &lt;- sum(diag(A)&gt;0)/S
  
  return(data.frame(L=L,C=C,GenSD=GenSD,VulSD=VulSD,Top=Top,Bas=Bas,Int=Int,ChnLg=chain_length_mean,ChnSd=chain_length_sd,Cannib=Cannib))
}

otago_nodes &lt;- read.csv(&#39;data/Otago_Data_Nodes.csv&#39;)
otago_links &lt;- read.csv(&#39;data/Otago_Data_Links.csv&#39;)
otago_web &lt;- graph.data.frame(otago_links, vertices = otago_nodes, directed = T)

plot_web_trophic(otago_web)</code></pre>
<p><img src="figure/Networks_HW6.Rmd/unnamed-chunk-16-1.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code>empirical &lt;- calculateProperties(otago_web)</code></pre>
<p>Now generate N networks with the cascade and niche models and calculate their network properties.</p>
<pre class="r"><code>S=vcount(otago_web)
C=graph.density(otago_web)
N &lt;- 100

## Random model
webs &lt;- NULL
for (i in 1:N){
  webs[[i]] &lt;- matrix(data = rbinom(S*S,1,C),nrow = S, ncol = S)
}
graphs_list &lt;- NULL
for (i in 1:N){
  graphs_list[[i]] &lt;- graph.adjacency(webs[[i]], mode = &#39;directed&#39;)
}
generated_properties_random &lt;- lapply(graphs_list, calculateProperties) # apply the calculateProperties to every graph in the list of graphs.
generated_properties_random &lt;- do.call(rbind, generated_properties_random) # row-bind the data frames.
generated_properties_random &lt;- reshape2::melt(generated_properties_random) # This form is easier to plot


## Cascade model
webs &lt;- CommunityFactory(S=S, n=N, generator=CascadeModelLinks, C=C) # use this function to generate an object of class &quot;community&quot;
graphs_list &lt;- NULL
for (i in 1:N){
  graphs_list[[i]] &lt;- graph.data.frame(webs[[i]]$trophic.links, directed = T, vertices = webs[[i]]$nodes)
}
generated_properties_cascade &lt;- lapply(graphs_list, calculateProperties)
generated_properties_cascade &lt;- do.call(rbind, generated_properties_cascade)
generated_properties_cascade &lt;- reshape2::melt(generated_properties_cascade)

## Niche model
webs &lt;- CommunityFactory(S=S, n=N, generator=NicheModelLinks, C=C) # use this function to generate an object of class &quot;community&quot;
graphs_list &lt;- NULL
for (i in 1:N){
  graphs_list[[i]] &lt;- graph.data.frame(webs[[i]]$trophic.links, directed = T, vertices = webs[[i]]$nodes)
}
generated_properties_niche &lt;- lapply(graphs_list, calculateProperties)
generated_properties_niche &lt;- do.call(rbind, generated_properties_niche)
generated_properties_niche &lt;- reshape2::melt(generated_properties_niche)</code></pre>
<br>
<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-sessioninfo" data-toggle="collapse" data-target="#workflowr-sessioninfo" style="display: block;">
<span class="glyphicon glyphicon-wrench" aria-hidden="true"></span> Session information
</button>
</p>
<div id="workflowr-sessioninfo" class="collapse">
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>R version 4.0.3 (2020-10-10)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows 10 x64 (build 19042)

Matrix products: default

locale:
[1] LC_COLLATE=English_United States.1252 
[2] LC_CTYPE=English_United States.1252   
[3] LC_MONETARY=English_United States.1252
[4] LC_NUMERIC=C                          
[5] LC_TIME=English_United States.1252    

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] ggpubr_0.4.0         Basingstoke_0.1-1    cheddar_0.1-636     
 [4] devtools_2.4.0       usethis_2.0.1        gtools_3.8.2        
 [7] reshape2_1.4.4       readxl_1.3.1         magrittr_2.0.1      
[10] forcats_0.5.1        stringr_1.4.0        purrr_0.3.4         
[13] readr_1.4.0          tidyr_1.1.3          tibble_3.0.4        
[16] tidyverse_1.3.1      RColorBrewer_1.1-2   ggplot2_3.3.3       
[19] dplyr_1.0.5          bipartite_2.16       sna_2.6             
[22] network_1.16.1       statnet.common_4.4.1 vegan_2.5-7         
[25] lattice_0.20-41      permute_0.9-5        igraph_1.2.6        
[28] workflowr_1.6.2     

loaded via a namespace (and not attached):
 [1] colorspace_2.0-0  ggsignif_0.6.1    rio_0.5.26        ellipsis_0.3.1   
 [5] rprojroot_2.0.2   fs_1.5.0          rstudioapi_0.13   farver_2.1.0     
 [9] remotes_2.3.0     fansi_0.4.2       lubridate_1.7.10  xml2_1.3.2       
[13] splines_4.0.3     cachem_1.0.4      knitr_1.33        pkgload_1.2.1    
[17] spam_2.6-0        jsonlite_1.7.2    broom_0.7.6       cluster_2.1.0    
[21] dbplyr_2.1.1      compiler_4.0.3    httr_1.4.2        backports_1.2.1  
[25] assertthat_0.2.1  Matrix_1.2-18     fastmap_1.1.0     cli_2.5.0        
[29] later_1.2.0       htmltools_0.5.1.1 prettyunits_1.1.1 tools_4.0.3      
[33] dotCall64_1.0-1   coda_0.19-4       gtable_0.3.0      glue_1.4.2       
[37] maps_3.3.0        Rcpp_1.0.5        carData_3.0-4     rle_0.9.2        
[41] cellranger_1.1.0  jquerylib_0.1.4   vctrs_0.3.6       nlme_3.1-149     
[45] xfun_0.22         ps_1.6.0          openxlsx_4.2.3    testthat_3.0.2   
[49] rvest_1.0.0       lifecycle_1.0.0   rstatix_0.7.0     MASS_7.3-53      
[53] scales_1.1.1      hms_1.0.0         promises_1.2.0.1  parallel_4.0.3   
[57] fields_11.6       curl_4.3.1        yaml_2.2.1        memoise_2.0.0    
[61] sass_0.3.1        stringi_1.5.3     highr_0.9         desc_1.3.0       
[65] zip_2.1.1         pkgbuild_1.2.0    rlang_0.4.10      pkgconfig_2.0.3  
[69] evaluate_0.14     labeling_0.4.2    cowplot_1.1.1     tidyselect_1.1.1 
[73] processx_3.5.1    plyr_1.8.6        R6_2.5.0          generics_0.1.0   
[77] DBI_1.1.1         foreign_0.8-80    pillar_1.6.0      haven_2.4.1      
[81] whisker_0.4       withr_2.4.2       mgcv_1.8-33       abind_1.4-5      
[85] car_3.0-10        modelr_0.1.8      crayon_1.4.1      utf8_1.1.4       
[89] rmarkdown_2.7     grid_4.0.3        data.table_1.14.0 callr_3.7.0      
[93] git2r_0.28.0      reprex_2.0.0      digest_0.6.27     httpuv_1.6.0     
[97] munsell_0.5.0     bslib_0.2.4       sessioninfo_1.1.1</code></pre>
</div>
</div>
</div>


<!-- Adjust MathJax settings so that all math formulae are shown using
TeX fonts only; see
http://docs.mathjax.org/en/latest/configuration.html.  This will make
the presentation more consistent at the cost of the webpage sometimes
taking slightly longer to load. Note that this only works because the
footer is added to webpages before the MathJax javascript. -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": { availableFonts: ["TeX"] }
  });
</script>




</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
